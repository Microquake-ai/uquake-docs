<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.1.0"/>
    <title>uquake.core.stream API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../core.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;uquake.core</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Stream">Stream</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Stream.__init__">Stream</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.composite">composite</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.select">select</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.as_array">as_array</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.chan_groups">chan_groups</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.channel_map">channel_map</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.write">write</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.write_bytes">write_bytes</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.valid">valid</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.concat">concat</a>
                        </li>
                        <li>
                                <a class="variable" href="#Stream.unique_stations">unique_stations</a>
                        </li>
                        <li>
                                <a class="variable" href="#Stream.unique_instruments">unique_instruments</a>
                        </li>
                        <li>
                                <a class="variable" href="#Stream.stations">stations</a>
                        </li>
                        <li>
                                <a class="variable" href="#Stream.instruments">instruments</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.zpad_names">zpad_names</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.zstrip_names">zstrip_names</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.distance_time_plot">distance_time_plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.create_from_json_traces">create_from_json_traces</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.to_traces_json">to_traces_json</a>
                        </li>
                        <li>
                                <a class="function" href="#Stream.plot">plot</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#is_valid">is_valid</a>
            </li>
            <li>
                    <a class="function" href="#check_for_dead_trace">check_for_dead_trace</a>
            </li>
            <li>
                    <a class="function" href="#composite_traces">composite_traces</a>
            </li>
            <li>
                    <a class="function" href="#read">read</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../uquake.html">uquake</a><wbr>.<a href="./../core.html">core</a><wbr>.stream    </h1>

                        <div class="docstring"><p>Expansion of the obspy.core.stream module</p>

<p>:copyright:
    uquake development team (devs@uquake.org)
:license:
    GNU Lesser General Public License, Version 3
    (<a href="http://www.gnu.org/copyleft/lesser.html">http://www.gnu.org/copyleft/lesser.html</a>)</p>
</div>

                        <input id="mod-stream-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-stream-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="c1"># Copyright (C) 2023, Jean-Philippe Mercier</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="c1">#</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="c1"># This program is free software: you can redistribute it and/or modify</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="c1"># it under the terms of the GNU Affero General Public License as published by</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="c1"># (at your option) any later version.</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="c1">#</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="c1"># This program is distributed in the hope that it will be useful,</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="c1"># GNU Affero General Public License for more details.</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="c1">#</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="c1"># You should have received a copy of the GNU Affero General Public License</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="c1"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="c1"># ------------------------------------------------------------------</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="c1"># Filename: core.py</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="c1">#  Purpose: Expansion of the obspy.core.stream module</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="c1">#   Author: uquake development team</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="c1">#    Email: devs@uquake.org</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="c1">#</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="c1"># Copyright (C) 2016 uquake development team</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="c1"># --------------------------------------------------------------------</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">Expansion of the obspy.core.stream module</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">:copyright:</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">    uquake development team (devs@uquake.org)</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">:license:</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">    GNU Lesser General Public License, Version 3</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    (http://www.gnu.org/copyleft/lesser.html)</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="kn">import</span> <span class="nn">obspy.core.stream</span> <span class="k">as</span> <span class="nn">obsstream</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="kn">from</span> <span class="nn">pkg_resources</span> <span class="kn">import</span> <span class="n">load_entry_point</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="kn">from</span> <span class="nn">.trace</span> <span class="kn">import</span> <span class="n">Trace</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="kn">from</span> <span class="nn">.util</span> <span class="kn">import</span> <span class="n">ENTRY_POINTS</span><span class="p">,</span> <span class="n">tools</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="kn">from</span> <span class="nn">.logging</span> <span class="kn">import</span> <span class="n">logger</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="k">class</span> <span class="nc">Stream</span><span class="p">(</span><span class="n">obsstream</span><span class="o">.</span><span class="n">Stream</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="vm">__doc__</span> <span class="o">=</span> <span class="n">obsstream</span><span class="o">.</span><span class="n">Stream</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;obspy&#39;</span><span class="p">,</span> <span class="s1">&#39;uquake&#39;</span><span class="p">)</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Stream</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>        <span class="k">if</span> <span class="n">stream</span><span class="p">:</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>            <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>            <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">traces</span><span class="p">:</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>                <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Trace</span><span class="p">(</span><span class="n">trace</span><span class="o">=</span><span class="n">tr</span><span class="p">))</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="n">traces</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>    <span class="k">def</span> <span class="nf">composite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        returns a new stream object containing composite trace for all station.</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">        The amplitude of the composite traces are the norm of the amplitude of</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        the trace of all component and the phase of the trace (sign) is the</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        sign of the first components of a given station.</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        :param st: a stream object</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        :type st: ~uquake.core.stream.Stream</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">        :rtype: ~uquake.core.stream.Stream</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>        <span class="k">return</span> <span class="n">composite_traces</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>        <span class="k">if</span> <span class="s1">&#39;location&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>            <span class="n">trs</span> <span class="o">=</span> <span class="p">[</span><span class="n">tr</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]]</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        <span class="n">st_tmp</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="n">trs</span><span class="p">)</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>        <span class="n">kwargs_tmp</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>                <span class="k">continue</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>            <span class="n">kwargs_tmp</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>        <span class="k">return</span> <span class="n">st_tmp</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs_tmp</span><span class="p">)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>    <span class="k">def</span> <span class="nf">as_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wlen_sec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">taplen</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="n">t0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>        <span class="n">sr</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>        <span class="k">if</span> <span class="n">wlen_sec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>            <span class="n">npts_fix</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">wlen_sec</span> <span class="o">*</span> <span class="n">sr</span><span class="p">)</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>            <span class="n">npts_fix</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]))</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>        <span class="k">return</span> <span class="n">tools</span><span class="o">.</span><span class="n">stream_to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">npts_fix</span><span class="p">,</span> <span class="n">taplen</span><span class="o">=</span><span class="n">taplen</span><span class="p">),</span> <span class="n">sr</span><span class="p">,</span> <span class="n">t0</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">chan_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>        <span class="n">chanmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_map</span><span class="p">()</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sk</span> <span class="o">==</span> <span class="n">chanmap</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">sk</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">chanmap</span><span class="p">)]</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="n">groups</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>    <span class="k">def</span> <span class="nf">channel_map</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>        <span class="n">stations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>        <span class="n">unique</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">stations</span><span class="p">)</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        <span class="n">unique_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique</span><span class="p">))))</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="n">chanmap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">unique_dict</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        <span class="k">return</span> <span class="n">chanmap</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;MSEED&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>        <span class="kn">from</span> <span class="nn">six</span> <span class="kn">import</span> <span class="n">string_types</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">filename</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;gz&#39;</span><span class="p">):</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>                <span class="kn">import</span> <span class="nn">gzip</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>            <span class="k">elif</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;bz2&#39;</span><span class="p">):</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>                <span class="kn">import</span> <span class="nn">bz2</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">BZ2File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>            <span class="k">elif</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;zip&#39;</span><span class="p">):</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Zip protocol is not supported&#39;</span><span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>        <span class="n">st_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>        <span class="k">return</span> <span class="n">obsstream</span><span class="o">.</span><span class="n">Stream</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">st_out</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>    <span class="n">write</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">obsstream</span><span class="o">.</span><span class="n">Stream</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;obspy&#39;</span><span class="p">,</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>                                                           <span class="s1">&#39;uquake&#39;</span><span class="p">)</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>    <span class="k">def</span> <span class="nf">write_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        <span class="n">buf</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;MSEED&#39;</span><span class="p">)</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="n">buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>    <span class="k">def</span> <span class="nf">valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>        <span class="k">return</span> <span class="n">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>    <span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comp_st</span><span class="p">):</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">comp_st</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        <span class="k">if</span> <span class="n">c</span><span class="p">:</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">comp_st</span><span class="o">.</span><span class="n">traces</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">)):</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">detrend_norm</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>                <span class="n">comp_st</span><span class="o">.</span><span class="n">traces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">detrend_norm</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>            <span class="n">comp_st</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="n">comp_st</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>    <span class="nd">@property</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>    <span class="k">def</span> <span class="nf">unique_stations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]))</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>    <span class="nd">@property</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>    <span class="k">def</span> <span class="nf">unique_instruments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">location</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]))</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>    <span class="nd">@property</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>    <span class="k">def</span> <span class="nf">stations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_stations</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>    <span class="nd">@property</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>    <span class="k">def</span> <span class="nf">instruments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_instruments</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>    <span class="k">def</span> <span class="nf">zpad_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">:</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>            <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>    <span class="k">def</span> <span class="nf">zstrip_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">:</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>            <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>    <span class="k">def</span> <span class="nf">distance_time_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">freq_min</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>                           <span class="n">freq_max</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">        plot traces that have</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">        :param event: event object</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">        :param location: location object</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">        :param scale: vertical size of pick markers and waveform</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="sd">        :return: plot handler</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>        <span class="n">st</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s1">&#39;demean&#39;</span><span class="p">)</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">taper</span><span class="p">(</span><span class="n">max_percentage</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">freqmin</span><span class="o">=</span><span class="n">freq_min</span><span class="p">,</span> <span class="n">freqmax</span><span class="o">=</span><span class="n">freq_max</span><span class="p">)</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="c1"># initializing the plot</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">preferred_origin</span><span class="p">():</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>            <span class="n">origin</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">preferred_origin</span><span class="p">()</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">:</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>            <span class="n">origin</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>            <span class="k">return</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>        <span class="n">event_location</span> <span class="o">=</span> <span class="n">origin</span><span class="o">.</span><span class="n">loc</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="c1"># find the earliest start time and latest end time</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="n">end_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st</span><span class="p">:</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">start_time</span><span class="p">:</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>            <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="o">&lt;</span> <span class="n">start_time</span><span class="p">:</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>            <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span> <span class="o">&gt;</span> <span class="n">end_time</span><span class="p">:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st</span><span class="p">:</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>            <span class="n">station_code</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>            <span class="c1"># search for arrival</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>            <span class="n">station</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">station_code</span><span class="p">)</span><span class="o">.</span><span class="n">stations</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>            <span class="n">station_location</span> <span class="o">=</span> <span class="n">station</span><span class="o">.</span><span class="n">loc</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>            <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">event_location</span> <span class="o">-</span> <span class="n">station_location</span><span class="p">)</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>            <span class="n">p_pick</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>            <span class="n">s_pick</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span> <span class="o">*</span> <span class="n">scale</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>            <span class="n">time_delta</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>            <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">/</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">+</span> \
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>                   <span class="n">time_delta</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>            <span class="k">for</span> <span class="n">arrival</span> <span class="ow">in</span> <span class="n">origin</span><span class="o">.</span><span class="n">arrivals</span><span class="p">:</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>                <span class="k">if</span> <span class="n">arrival</span><span class="o">.</span><span class="n">get_pick</span><span class="p">()</span><span class="o">.</span><span class="n">waveform_id</span><span class="o">.</span><span class="n">station_code</span> <span class="o">==</span> <span class="n">station_code</span><span class="p">:</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>                    <span class="n">distance</span> <span class="o">=</span> <span class="n">arrival</span><span class="o">.</span><span class="n">distance</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>                    <span class="k">if</span> <span class="n">arrival</span><span class="o">.</span><span class="n">phase</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>                        <span class="n">p_pick</span> <span class="o">=</span> <span class="n">arrival</span><span class="o">.</span><span class="n">get_pick</span><span class="p">()</span><span class="o">.</span><span class="n">time</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>                    <span class="k">elif</span> <span class="n">arrival</span><span class="o">.</span><span class="n">phase</span> <span class="o">==</span> <span class="s1">&#39;S&#39;</span><span class="p">:</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>                        <span class="n">s_pick</span> <span class="o">=</span> <span class="n">arrival</span><span class="o">.</span><span class="n">get_pick</span><span class="p">()</span><span class="o">.</span><span class="n">time</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span> <span class="o">+</span> <span class="n">distance</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>            <span class="k">if</span> <span class="n">p_pick</span><span class="p">:</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">p_pick</span><span class="p">,</span> <span class="n">distance</span> <span class="o">-</span> <span class="n">scale</span><span class="p">,</span> <span class="n">distance</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>            <span class="k">if</span> <span class="n">s_pick</span><span class="p">:</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">s_pick</span><span class="p">,</span> <span class="n">distance</span> <span class="o">-</span> <span class="n">scale</span><span class="p">,</span> <span class="n">distance</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;relative time (s)&#39;</span><span class="p">)</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;distance from event (m)&#39;</span><span class="p">)</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>    <span class="k">def</span> <span class="nf">create_from_json_traces</span><span class="p">(</span><span class="n">traces_json_list</span><span class="p">):</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>        <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>        <span class="c1"># for tr_json in traces_json_list:</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tr_json</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">traces_json_list</span><span class="p">):</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>            <span class="n">stats</span> <span class="o">=</span> <span class="n">tr_json</span><span class="p">[</span><span class="s1">&#39;stats&#39;</span><span class="p">]</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>            <span class="n">tr</span> <span class="o">=</span> <span class="n">Trace</span><span class="o">.</span><span class="n">create_from_json</span><span class="p">(</span><span class="n">tr_json</span><span class="p">)</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tr</span><span class="p">)</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="k">return</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="n">traces</span><span class="p">)</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>    <span class="k">def</span> <span class="nf">to_traces_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>        <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>            <span class="n">trout</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trout</span><span class="p">)</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="k">return</span> <span class="n">traces</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">        see Obspy stream.plot()</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>        <span class="kn">from</span> <span class="nn">..imaging.waveform</span> <span class="kn">import</span> <span class="n">WaveformPlotting</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>        <span class="n">waveform</span> <span class="o">=</span> <span class="n">WaveformPlotting</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="k">return</span> <span class="n">waveform</span><span class="o">.</span><span class="n">plotWaveform</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="c1"># from uquake.core import read, read_events</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a><span class="c1"># from spp.utils import application</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a><span class="c1"># app = application.Application()</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="c1"># location = app.get_stations()</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="c1"># st = read(&#39;2018-11-08T10:21:49.898496Z.mseed&#39;, format=&#39;mseed&#39;)</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="c1"># cat = read_events(&#39;test.xml&#39;)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="c1"># evt = cat[0]</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a><span class="c1"># st = st.composite()</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="n">st_in</span><span class="p">,</span> <span class="n">return_stream</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">STA</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">LTA</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">min_num_valid</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a><span class="sd">        Determine if an event is valid or return valid traces in a  stream</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a><span class="sd">        :param st_in: stream</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="sd">        :type st_in: uquake.core.stream.Stream</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a><span class="sd">        :param return_stream: return stream of valid traces if true else return</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a><span class="sd">        true if the event is valid</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a><span class="sd">        :type return_stream: bool</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="sd">        :param STA: short term average used to determine if an event is valid</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">        :type STA: float</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">        :param LTA: long term average</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">        :type LTA: float</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">        :param min_num_valid: minimum number of valid traces to declare the</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">        event valid</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">        :type min_num_valid: int</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">        :rtype: bool or uquake.core.stream.Stream</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>    <span class="kn">from</span> <span class="nn">scipy.ndimage.filters</span> <span class="kn">import</span> <span class="n">gaussian_filter1d</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>    <span class="kn">from</span> <span class="nn">obspy.signal.trigger</span> <span class="kn">import</span> <span class="n">recursive_sta_lta</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>    <span class="n">st</span> <span class="o">=</span> <span class="n">st_in</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>    <span class="n">st</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s1">&#39;demean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>    <span class="n">trstd</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>    <span class="n">trmax</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>    <span class="n">trs_out</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>    <span class="n">st_comp</span> <span class="o">=</span> <span class="n">composite_traces</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>    <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st_comp</span><span class="p">:</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>            <span class="k">continue</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>        <span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>        <span class="n">trstd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>        <span class="n">trmax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>        <span class="n">nsta</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">STA</span> <span class="o">*</span> <span class="n">sampling_rate</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="n">nlta</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">LTA</span> <span class="o">*</span> <span class="n">sampling_rate</span><span class="p">)</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>        <span class="n">cft</span> <span class="o">=</span> <span class="n">recursive_sta_lta</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="n">nsta</span><span class="p">,</span> <span class="n">nlta</span><span class="p">)</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>        <span class="n">sfreq</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;sampling_rate&#39;</span><span class="p">]</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>        <span class="n">sigma</span> <span class="o">=</span> <span class="n">sfreq</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>        <span class="n">cft</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">cft</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;reflect&#39;</span><span class="p">)</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>            <span class="n">mx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="n">cft</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">&gt;</span> <span class="n">cft</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">&amp;</span> \
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>                 <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">cft</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">cft</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="kc">True</span><span class="p">]</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>            <span class="k">continue</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>        <span class="n">i1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">mx</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>        <span class="n">i2</span> <span class="o">=</span> <span class="n">i1</span><span class="p">[</span><span class="n">cft</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">cft</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>        <span class="n">tspan</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">i2</span><span class="p">))</span> <span class="o">/</span> <span class="n">sampling_rate</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="n">ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>        <span class="n">accept</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>            <span class="k">if</span> <span class="n">ratio</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>                <span class="n">accept</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>            <span class="n">accept</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>        <span class="c1"># else:</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>        <span class="c1">#     if ratio &lt; 4:</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>        <span class="c1">#         accept = False</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>        <span class="k">if</span> <span class="n">tspan</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>            <span class="n">accept</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">tspan</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">tspan</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">):</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>            <span class="k">if</span> <span class="n">ratio</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>                <span class="n">accept</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>        <span class="k">if</span> <span class="n">accept</span><span class="p">:</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>            <span class="k">for</span> <span class="n">tr_accepted</span> <span class="ow">in</span> <span class="n">st_in</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">station</span><span class="o">=</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span><span class="p">):</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>                <span class="n">trs_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tr_accepted</span><span class="p">)</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>    <span class="n">st_out</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="n">trs_out</span><span class="p">)</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>    <span class="k">if</span> <span class="n">return_stream</span><span class="p">:</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>        <span class="k">return</span> <span class="n">st_out</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">unique_stations</span><span class="p">())</span> <span class="o">&gt;=</span> <span class="n">min_num_valid</span><span class="p">:</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="k">def</span> <span class="nf">check_for_dead_trace</span><span class="p">(</span><span class="n">tr</span><span class="p">):</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>    <span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-6</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>    <span class="nb">max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">mean</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>    <span class="nb">min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">mean</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>    <span class="c1"># print(&#39;%s: mean:%f max:%f min:%f&#39; % (tr.get_id(), mean, max, min))</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>    <span class="k">if</span> <span class="nb">max</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">min</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>        <span class="k">return</span> <span class="mi">1</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>        <span class="k">return</span> <span class="mi">0</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="k">def</span> <span class="nf">composite_traces</span><span class="p">(</span><span class="n">st_in</span><span class="p">):</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a><span class="sd">    Requires length and sampling_rates equal for all traces</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="sd">    returns a new stream object containing composite trace for all station.</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a><span class="sd">    The amplitude of the composite traces are the norm of the amplitude of</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="sd">    the trace of all component and the phase of the trace (sign) is the sign</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a><span class="sd">    of the first components of a given station.</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="sd">    :param st_in: a stream object</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a><span class="sd">    :type st_in: ~uquake.core.stream.Stream</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="sd">    :rtype: ~uquake.core.stream.Stream</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>    <span class="n">trsout</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>    <span class="n">st</span> <span class="o">=</span> <span class="n">st_in</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>    <span class="n">st</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s1">&#39;demean&#39;</span><span class="p">)</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>    <span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="n">st</span><span class="o">.</span><span class="n">unique_instruments</span><span class="p">:</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>        <span class="n">trs</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">trs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>            <span class="n">trsout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>            <span class="k">continue</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>        <span class="n">npts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="n">buf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">trs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">trs</span><span class="p">:</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>            <span class="n">dat</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">data</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>            <span class="n">buf</span> <span class="o">+=</span> <span class="p">(</span><span class="n">dat</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dat</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>        <span class="n">buf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">trs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>        <span class="n">stats</span> <span class="o">=</span> <span class="n">trs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>        <span class="n">ch</span> <span class="o">=</span> <span class="n">st_in</span><span class="o">.</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>            <span class="n">prefix</span> <span class="o">=</span> <span class="n">ch</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>        <span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">C&#39;</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>        <span class="n">trsout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Trace</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">buf</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">header</span><span class="o">=</span><span class="n">stats</span><span class="p">))</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>    <span class="k">return</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="n">trsout</span><span class="p">)</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a><span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;MSEED&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">Path</span><span class="p">):</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>        <span class="n">filename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>    <span class="k">if</span> <span class="nb">format</span> <span class="ow">in</span> <span class="n">ENTRY_POINTS</span><span class="p">[</span><span class="s1">&#39;waveform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>        <span class="n">format_ep</span> <span class="o">=</span> <span class="n">ENTRY_POINTS</span><span class="p">[</span><span class="s1">&#39;waveform&#39;</span><span class="p">][</span><span class="nb">format</span><span class="p">]</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>            <span class="n">read_format</span> <span class="o">=</span> <span class="n">load_entry_point</span><span class="p">(</span><span class="n">format_ep</span><span class="o">.</span><span class="n">dist</span><span class="o">.</span><span class="n">key</span><span class="p">,</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>                                           <span class="s1">&#39;uquake.io.waveform.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>                                           <span class="n">format_ep</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;readFormat&#39;</span><span class="p">)</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>            <span class="k">return</span> <span class="n">Stream</span><span class="p">(</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>                <span class="n">stream</span><span class="o">=</span><span class="n">obsstream</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>        <span class="n">st</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">read_format</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>        <span class="c1"># making sure the channel names are upper case</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>        <span class="n">trs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st</span><span class="p">:</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>            <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>            <span class="n">trs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="n">trs</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>        <span class="k">return</span> <span class="n">st</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>        <span class="k">return</span> <span class="n">Stream</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">obsstream</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a><span class="n">read</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">obsstream</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;obspy&#39;</span><span class="p">,</span> <span class="s1">&#39;uquake&#39;</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="Stream">
                            <input id="Stream-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Stream</span><wbr>(<span class="base">obspy.core.stream.Stream</span>, <span class="base">abc.ABC</span>):

                <label class="view-source-button" for="Stream-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream-48"><a href="#Stream-48"><span class="linenos"> 48</span></a><span class="k">class</span> <span class="nc">Stream</span><span class="p">(</span><span class="n">obsstream</span><span class="o">.</span><span class="n">Stream</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
</span><span id="Stream-49"><a href="#Stream-49"><span class="linenos"> 49</span></a>    <span class="vm">__doc__</span> <span class="o">=</span> <span class="n">obsstream</span><span class="o">.</span><span class="n">Stream</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;obspy&#39;</span><span class="p">,</span> <span class="s1">&#39;uquake&#39;</span><span class="p">)</span>
</span><span id="Stream-50"><a href="#Stream-50"><span class="linenos"> 50</span></a>
</span><span id="Stream-51"><a href="#Stream-51"><span class="linenos"> 51</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Stream-52"><a href="#Stream-52"><span class="linenos"> 52</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Stream</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Stream-53"><a href="#Stream-53"><span class="linenos"> 53</span></a>
</span><span id="Stream-54"><a href="#Stream-54"><span class="linenos"> 54</span></a>        <span class="k">if</span> <span class="n">stream</span><span class="p">:</span>
</span><span id="Stream-55"><a href="#Stream-55"><span class="linenos"> 55</span></a>            <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stream-56"><a href="#Stream-56"><span class="linenos"> 56</span></a>
</span><span id="Stream-57"><a href="#Stream-57"><span class="linenos"> 57</span></a>            <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">traces</span><span class="p">:</span>
</span><span id="Stream-58"><a href="#Stream-58"><span class="linenos"> 58</span></a>                <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Trace</span><span class="p">(</span><span class="n">trace</span><span class="o">=</span><span class="n">tr</span><span class="p">))</span>
</span><span id="Stream-59"><a href="#Stream-59"><span class="linenos"> 59</span></a>
</span><span id="Stream-60"><a href="#Stream-60"><span class="linenos"> 60</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="n">traces</span>
</span><span id="Stream-61"><a href="#Stream-61"><span class="linenos"> 61</span></a>
</span><span id="Stream-62"><a href="#Stream-62"><span class="linenos"> 62</span></a>    <span class="k">def</span> <span class="nf">composite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream-63"><a href="#Stream-63"><span class="linenos"> 63</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stream-64"><a href="#Stream-64"><span class="linenos"> 64</span></a><span class="sd">        returns a new stream object containing composite trace for all station.</span>
</span><span id="Stream-65"><a href="#Stream-65"><span class="linenos"> 65</span></a><span class="sd">        The amplitude of the composite traces are the norm of the amplitude of</span>
</span><span id="Stream-66"><a href="#Stream-66"><span class="linenos"> 66</span></a><span class="sd">        the trace of all component and the phase of the trace (sign) is the</span>
</span><span id="Stream-67"><a href="#Stream-67"><span class="linenos"> 67</span></a><span class="sd">        sign of the first components of a given station.</span>
</span><span id="Stream-68"><a href="#Stream-68"><span class="linenos"> 68</span></a><span class="sd">        :param st: a stream object</span>
</span><span id="Stream-69"><a href="#Stream-69"><span class="linenos"> 69</span></a><span class="sd">        :type st: ~uquake.core.stream.Stream</span>
</span><span id="Stream-70"><a href="#Stream-70"><span class="linenos"> 70</span></a><span class="sd">        :rtype: ~uquake.core.stream.Stream</span>
</span><span id="Stream-71"><a href="#Stream-71"><span class="linenos"> 71</span></a>
</span><span id="Stream-72"><a href="#Stream-72"><span class="linenos"> 72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stream-73"><a href="#Stream-73"><span class="linenos"> 73</span></a>
</span><span id="Stream-74"><a href="#Stream-74"><span class="linenos"> 74</span></a>        <span class="k">return</span> <span class="n">composite_traces</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Stream-75"><a href="#Stream-75"><span class="linenos"> 75</span></a>
</span><span id="Stream-76"><a href="#Stream-76"><span class="linenos"> 76</span></a>    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Stream-77"><a href="#Stream-77"><span class="linenos"> 77</span></a>        <span class="k">if</span> <span class="s1">&#39;location&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Stream-78"><a href="#Stream-78"><span class="linenos"> 78</span></a>            <span class="n">trs</span> <span class="o">=</span> <span class="p">[</span><span class="n">tr</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]]</span>
</span><span id="Stream-79"><a href="#Stream-79"><span class="linenos"> 79</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Stream-80"><a href="#Stream-80"><span class="linenos"> 80</span></a>            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Stream-81"><a href="#Stream-81"><span class="linenos"> 81</span></a>
</span><span id="Stream-82"><a href="#Stream-82"><span class="linenos"> 82</span></a>        <span class="n">st_tmp</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="n">trs</span><span class="p">)</span>
</span><span id="Stream-83"><a href="#Stream-83"><span class="linenos"> 83</span></a>
</span><span id="Stream-84"><a href="#Stream-84"><span class="linenos"> 84</span></a>        <span class="n">kwargs_tmp</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Stream-85"><a href="#Stream-85"><span class="linenos"> 85</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Stream-86"><a href="#Stream-86"><span class="linenos"> 86</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span>
</span><span id="Stream-87"><a href="#Stream-87"><span class="linenos"> 87</span></a>                <span class="k">continue</span>
</span><span id="Stream-88"><a href="#Stream-88"><span class="linenos"> 88</span></a>            <span class="n">kwargs_tmp</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="Stream-89"><a href="#Stream-89"><span class="linenos"> 89</span></a>
</span><span id="Stream-90"><a href="#Stream-90"><span class="linenos"> 90</span></a>        <span class="k">return</span> <span class="n">st_tmp</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs_tmp</span><span class="p">)</span>
</span><span id="Stream-91"><a href="#Stream-91"><span class="linenos"> 91</span></a>
</span><span id="Stream-92"><a href="#Stream-92"><span class="linenos"> 92</span></a>    <span class="k">def</span> <span class="nf">as_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wlen_sec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">taplen</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
</span><span id="Stream-93"><a href="#Stream-93"><span class="linenos"> 93</span></a>        <span class="n">t0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>
</span><span id="Stream-94"><a href="#Stream-94"><span class="linenos"> 94</span></a>        <span class="n">sr</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>
</span><span id="Stream-95"><a href="#Stream-95"><span class="linenos"> 95</span></a>
</span><span id="Stream-96"><a href="#Stream-96"><span class="linenos"> 96</span></a>        <span class="k">if</span> <span class="n">wlen_sec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Stream-97"><a href="#Stream-97"><span class="linenos"> 97</span></a>            <span class="n">npts_fix</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">wlen_sec</span> <span class="o">*</span> <span class="n">sr</span><span class="p">)</span>
</span><span id="Stream-98"><a href="#Stream-98"><span class="linenos"> 98</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Stream-99"><a href="#Stream-99"><span class="linenos"> 99</span></a>            <span class="n">npts_fix</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]))</span>
</span><span id="Stream-100"><a href="#Stream-100"><span class="linenos">100</span></a>
</span><span id="Stream-101"><a href="#Stream-101"><span class="linenos">101</span></a>        <span class="k">return</span> <span class="n">tools</span><span class="o">.</span><span class="n">stream_to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">npts_fix</span><span class="p">,</span> <span class="n">taplen</span><span class="o">=</span><span class="n">taplen</span><span class="p">),</span> <span class="n">sr</span><span class="p">,</span> <span class="n">t0</span>
</span><span id="Stream-102"><a href="#Stream-102"><span class="linenos">102</span></a>
</span><span id="Stream-103"><a href="#Stream-103"><span class="linenos">103</span></a>    <span class="k">def</span> <span class="nf">chan_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream-104"><a href="#Stream-104"><span class="linenos">104</span></a>        <span class="n">chanmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_map</span><span class="p">()</span>
</span><span id="Stream-105"><a href="#Stream-105"><span class="linenos">105</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sk</span> <span class="o">==</span> <span class="n">chanmap</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">sk</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">chanmap</span><span class="p">)]</span>
</span><span id="Stream-106"><a href="#Stream-106"><span class="linenos">106</span></a>
</span><span id="Stream-107"><a href="#Stream-107"><span class="linenos">107</span></a>        <span class="k">return</span> <span class="n">groups</span>
</span><span id="Stream-108"><a href="#Stream-108"><span class="linenos">108</span></a>
</span><span id="Stream-109"><a href="#Stream-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="nf">channel_map</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream-110"><a href="#Stream-110"><span class="linenos">110</span></a>        <span class="n">stations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>
</span><span id="Stream-111"><a href="#Stream-111"><span class="linenos">111</span></a>        <span class="n">unique</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">stations</span><span class="p">)</span>
</span><span id="Stream-112"><a href="#Stream-112"><span class="linenos">112</span></a>        <span class="n">unique_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique</span><span class="p">))))</span>
</span><span id="Stream-113"><a href="#Stream-113"><span class="linenos">113</span></a>        <span class="n">chanmap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">unique_dict</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span><span id="Stream-114"><a href="#Stream-114"><span class="linenos">114</span></a>
</span><span id="Stream-115"><a href="#Stream-115"><span class="linenos">115</span></a>        <span class="k">return</span> <span class="n">chanmap</span>
</span><span id="Stream-116"><a href="#Stream-116"><span class="linenos">116</span></a>
</span><span id="Stream-117"><a href="#Stream-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;MSEED&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Stream-118"><a href="#Stream-118"><span class="linenos">118</span></a>
</span><span id="Stream-119"><a href="#Stream-119"><span class="linenos">119</span></a>        <span class="kn">from</span> <span class="nn">six</span> <span class="kn">import</span> <span class="n">string_types</span>
</span><span id="Stream-120"><a href="#Stream-120"><span class="linenos">120</span></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">filename</span>
</span><span id="Stream-121"><a href="#Stream-121"><span class="linenos">121</span></a>
</span><span id="Stream-122"><a href="#Stream-122"><span class="linenos">122</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
</span><span id="Stream-123"><a href="#Stream-123"><span class="linenos">123</span></a>            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;gz&#39;</span><span class="p">):</span>
</span><span id="Stream-124"><a href="#Stream-124"><span class="linenos">124</span></a>                <span class="kn">import</span> <span class="nn">gzip</span>
</span><span id="Stream-125"><a href="#Stream-125"><span class="linenos">125</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="Stream-126"><a href="#Stream-126"><span class="linenos">126</span></a>            <span class="k">elif</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;bz2&#39;</span><span class="p">):</span>
</span><span id="Stream-127"><a href="#Stream-127"><span class="linenos">127</span></a>                <span class="kn">import</span> <span class="nn">bz2</span>
</span><span id="Stream-128"><a href="#Stream-128"><span class="linenos">128</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">BZ2File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="Stream-129"><a href="#Stream-129"><span class="linenos">129</span></a>            <span class="k">elif</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;zip&#39;</span><span class="p">):</span>
</span><span id="Stream-130"><a href="#Stream-130"><span class="linenos">130</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Zip protocol is not supported&#39;</span><span class="p">)</span>
</span><span id="Stream-131"><a href="#Stream-131"><span class="linenos">131</span></a>
</span><span id="Stream-132"><a href="#Stream-132"><span class="linenos">132</span></a>        <span class="n">st_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Stream-133"><a href="#Stream-133"><span class="linenos">133</span></a>
</span><span id="Stream-134"><a href="#Stream-134"><span class="linenos">134</span></a>        <span class="k">return</span> <span class="n">obsstream</span><span class="o">.</span><span class="n">Stream</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">st_out</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Stream-135"><a href="#Stream-135"><span class="linenos">135</span></a>
</span><span id="Stream-136"><a href="#Stream-136"><span class="linenos">136</span></a>    <span class="n">write</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">obsstream</span><span class="o">.</span><span class="n">Stream</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;obspy&#39;</span><span class="p">,</span>
</span><span id="Stream-137"><a href="#Stream-137"><span class="linenos">137</span></a>                                                           <span class="s1">&#39;uquake&#39;</span><span class="p">)</span>
</span><span id="Stream-138"><a href="#Stream-138"><span class="linenos">138</span></a>
</span><span id="Stream-139"><a href="#Stream-139"><span class="linenos">139</span></a>    <span class="k">def</span> <span class="nf">write_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream-140"><a href="#Stream-140"><span class="linenos">140</span></a>        <span class="n">buf</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Stream-141"><a href="#Stream-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;MSEED&#39;</span><span class="p">)</span>
</span><span id="Stream-142"><a href="#Stream-142"><span class="linenos">142</span></a>
</span><span id="Stream-143"><a href="#Stream-143"><span class="linenos">143</span></a>        <span class="k">return</span> <span class="n">buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</span><span id="Stream-144"><a href="#Stream-144"><span class="linenos">144</span></a>
</span><span id="Stream-145"><a href="#Stream-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Stream-146"><a href="#Stream-146"><span class="linenos">146</span></a>        <span class="k">return</span> <span class="n">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Stream-147"><a href="#Stream-147"><span class="linenos">147</span></a>
</span><span id="Stream-148"><a href="#Stream-148"><span class="linenos">148</span></a>    <span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comp_st</span><span class="p">):</span>
</span><span id="Stream-149"><a href="#Stream-149"><span class="linenos">149</span></a>
</span><span id="Stream-150"><a href="#Stream-150"><span class="linenos">150</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">comp_st</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="Stream-151"><a href="#Stream-151"><span class="linenos">151</span></a>
</span><span id="Stream-152"><a href="#Stream-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="n">c</span><span class="p">:</span>
</span><span id="Stream-153"><a href="#Stream-153"><span class="linenos">153</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">comp_st</span><span class="o">.</span><span class="n">traces</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">)):</span>
</span><span id="Stream-154"><a href="#Stream-154"><span class="linenos">154</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">detrend_norm</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
</span><span id="Stream-155"><a href="#Stream-155"><span class="linenos">155</span></a>                <span class="n">comp_st</span><span class="o">.</span><span class="n">traces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Stream-156"><a href="#Stream-156"><span class="linenos">156</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Stream-157"><a href="#Stream-157"><span class="linenos">157</span></a>            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Stream-158"><a href="#Stream-158"><span class="linenos">158</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">detrend_norm</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="Stream-159"><a href="#Stream-159"><span class="linenos">159</span></a>
</span><span id="Stream-160"><a href="#Stream-160"><span class="linenos">160</span></a>            <span class="n">comp_st</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Stream-161"><a href="#Stream-161"><span class="linenos">161</span></a>
</span><span id="Stream-162"><a href="#Stream-162"><span class="linenos">162</span></a>        <span class="k">return</span> <span class="n">comp_st</span>
</span><span id="Stream-163"><a href="#Stream-163"><span class="linenos">163</span></a>
</span><span id="Stream-164"><a href="#Stream-164"><span class="linenos">164</span></a>    <span class="nd">@property</span>
</span><span id="Stream-165"><a href="#Stream-165"><span class="linenos">165</span></a>    <span class="k">def</span> <span class="nf">unique_stations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream-166"><a href="#Stream-166"><span class="linenos">166</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]))</span>
</span><span id="Stream-167"><a href="#Stream-167"><span class="linenos">167</span></a>
</span><span id="Stream-168"><a href="#Stream-168"><span class="linenos">168</span></a>    <span class="nd">@property</span>
</span><span id="Stream-169"><a href="#Stream-169"><span class="linenos">169</span></a>    <span class="k">def</span> <span class="nf">unique_instruments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream-170"><a href="#Stream-170"><span class="linenos">170</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">location</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]))</span>
</span><span id="Stream-171"><a href="#Stream-171"><span class="linenos">171</span></a>
</span><span id="Stream-172"><a href="#Stream-172"><span class="linenos">172</span></a>    <span class="nd">@property</span>
</span><span id="Stream-173"><a href="#Stream-173"><span class="linenos">173</span></a>    <span class="k">def</span> <span class="nf">stations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream-174"><a href="#Stream-174"><span class="linenos">174</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_stations</span>
</span><span id="Stream-175"><a href="#Stream-175"><span class="linenos">175</span></a>
</span><span id="Stream-176"><a href="#Stream-176"><span class="linenos">176</span></a>    <span class="nd">@property</span>
</span><span id="Stream-177"><a href="#Stream-177"><span class="linenos">177</span></a>    <span class="k">def</span> <span class="nf">instruments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream-178"><a href="#Stream-178"><span class="linenos">178</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_instruments</span>
</span><span id="Stream-179"><a href="#Stream-179"><span class="linenos">179</span></a>
</span><span id="Stream-180"><a href="#Stream-180"><span class="linenos">180</span></a>    <span class="k">def</span> <span class="nf">zpad_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream-181"><a href="#Stream-181"><span class="linenos">181</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">:</span>
</span><span id="Stream-182"><a href="#Stream-182"><span class="linenos">182</span></a>            <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="Stream-183"><a href="#Stream-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="Stream-184"><a href="#Stream-184"><span class="linenos">184</span></a>
</span><span id="Stream-185"><a href="#Stream-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">zstrip_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream-186"><a href="#Stream-186"><span class="linenos">186</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">:</span>
</span><span id="Stream-187"><a href="#Stream-187"><span class="linenos">187</span></a>            <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
</span><span id="Stream-188"><a href="#Stream-188"><span class="linenos">188</span></a>
</span><span id="Stream-189"><a href="#Stream-189"><span class="linenos">189</span></a>    <span class="k">def</span> <span class="nf">distance_time_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">freq_min</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="Stream-190"><a href="#Stream-190"><span class="linenos">190</span></a>                           <span class="n">freq_max</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
</span><span id="Stream-191"><a href="#Stream-191"><span class="linenos">191</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stream-192"><a href="#Stream-192"><span class="linenos">192</span></a><span class="sd">        plot traces that have</span>
</span><span id="Stream-193"><a href="#Stream-193"><span class="linenos">193</span></a><span class="sd">        :param event: event object</span>
</span><span id="Stream-194"><a href="#Stream-194"><span class="linenos">194</span></a><span class="sd">        :param location: location object</span>
</span><span id="Stream-195"><a href="#Stream-195"><span class="linenos">195</span></a><span class="sd">        :param scale: vertical size of pick markers and waveform</span>
</span><span id="Stream-196"><a href="#Stream-196"><span class="linenos">196</span></a><span class="sd">        :return: plot handler</span>
</span><span id="Stream-197"><a href="#Stream-197"><span class="linenos">197</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stream-198"><a href="#Stream-198"><span class="linenos">198</span></a>
</span><span id="Stream-199"><a href="#Stream-199"><span class="linenos">199</span></a>        <span class="n">st</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Stream-200"><a href="#Stream-200"><span class="linenos">200</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s1">&#39;demean&#39;</span><span class="p">)</span>
</span><span id="Stream-201"><a href="#Stream-201"><span class="linenos">201</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">taper</span><span class="p">(</span><span class="n">max_percentage</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</span><span id="Stream-202"><a href="#Stream-202"><span class="linenos">202</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">freqmin</span><span class="o">=</span><span class="n">freq_min</span><span class="p">,</span> <span class="n">freqmax</span><span class="o">=</span><span class="n">freq_max</span><span class="p">)</span>
</span><span id="Stream-203"><a href="#Stream-203"><span class="linenos">203</span></a>
</span><span id="Stream-204"><a href="#Stream-204"><span class="linenos">204</span></a>        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="Stream-205"><a href="#Stream-205"><span class="linenos">205</span></a>        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="Stream-206"><a href="#Stream-206"><span class="linenos">206</span></a>
</span><span id="Stream-207"><a href="#Stream-207"><span class="linenos">207</span></a>        <span class="c1"># initializing the plot</span>
</span><span id="Stream-208"><a href="#Stream-208"><span class="linenos">208</span></a>
</span><span id="Stream-209"><a href="#Stream-209"><span class="linenos">209</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
</span><span id="Stream-210"><a href="#Stream-210"><span class="linenos">210</span></a>
</span><span id="Stream-211"><a href="#Stream-211"><span class="linenos">211</span></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">preferred_origin</span><span class="p">():</span>
</span><span id="Stream-212"><a href="#Stream-212"><span class="linenos">212</span></a>            <span class="n">origin</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">preferred_origin</span><span class="p">()</span>
</span><span id="Stream-213"><a href="#Stream-213"><span class="linenos">213</span></a>        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">:</span>
</span><span id="Stream-214"><a href="#Stream-214"><span class="linenos">214</span></a>            <span class="n">origin</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Stream-215"><a href="#Stream-215"><span class="linenos">215</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Stream-216"><a href="#Stream-216"><span class="linenos">216</span></a>            <span class="k">return</span>
</span><span id="Stream-217"><a href="#Stream-217"><span class="linenos">217</span></a>
</span><span id="Stream-218"><a href="#Stream-218"><span class="linenos">218</span></a>        <span class="n">event_location</span> <span class="o">=</span> <span class="n">origin</span><span class="o">.</span><span class="n">loc</span>
</span><span id="Stream-219"><a href="#Stream-219"><span class="linenos">219</span></a>
</span><span id="Stream-220"><a href="#Stream-220"><span class="linenos">220</span></a>        <span class="c1"># find the earliest start time and latest end time</span>
</span><span id="Stream-221"><a href="#Stream-221"><span class="linenos">221</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Stream-222"><a href="#Stream-222"><span class="linenos">222</span></a>        <span class="n">end_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Stream-223"><a href="#Stream-223"><span class="linenos">223</span></a>
</span><span id="Stream-224"><a href="#Stream-224"><span class="linenos">224</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st</span><span class="p">:</span>
</span><span id="Stream-225"><a href="#Stream-225"><span class="linenos">225</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">start_time</span><span class="p">:</span>
</span><span id="Stream-226"><a href="#Stream-226"><span class="linenos">226</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span>
</span><span id="Stream-227"><a href="#Stream-227"><span class="linenos">227</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span>
</span><span id="Stream-228"><a href="#Stream-228"><span class="linenos">228</span></a>
</span><span id="Stream-229"><a href="#Stream-229"><span class="linenos">229</span></a>            <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="o">&lt;</span> <span class="n">start_time</span><span class="p">:</span>
</span><span id="Stream-230"><a href="#Stream-230"><span class="linenos">230</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span>
</span><span id="Stream-231"><a href="#Stream-231"><span class="linenos">231</span></a>
</span><span id="Stream-232"><a href="#Stream-232"><span class="linenos">232</span></a>            <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span> <span class="o">&gt;</span> <span class="n">end_time</span><span class="p">:</span>
</span><span id="Stream-233"><a href="#Stream-233"><span class="linenos">233</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span>
</span><span id="Stream-234"><a href="#Stream-234"><span class="linenos">234</span></a>
</span><span id="Stream-235"><a href="#Stream-235"><span class="linenos">235</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st</span><span class="p">:</span>
</span><span id="Stream-236"><a href="#Stream-236"><span class="linenos">236</span></a>            <span class="n">station_code</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span>
</span><span id="Stream-237"><a href="#Stream-237"><span class="linenos">237</span></a>            <span class="c1"># search for arrival</span>
</span><span id="Stream-238"><a href="#Stream-238"><span class="linenos">238</span></a>            <span class="n">station</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">station_code</span><span class="p">)</span><span class="o">.</span><span class="n">stations</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Stream-239"><a href="#Stream-239"><span class="linenos">239</span></a>            <span class="n">station_location</span> <span class="o">=</span> <span class="n">station</span><span class="o">.</span><span class="n">loc</span>
</span><span id="Stream-240"><a href="#Stream-240"><span class="linenos">240</span></a>            <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">event_location</span> <span class="o">-</span> <span class="n">station_location</span><span class="p">)</span>
</span><span id="Stream-241"><a href="#Stream-241"><span class="linenos">241</span></a>            <span class="n">p_pick</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Stream-242"><a href="#Stream-242"><span class="linenos">242</span></a>            <span class="n">s_pick</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Stream-243"><a href="#Stream-243"><span class="linenos">243</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span> <span class="o">*</span> <span class="n">scale</span>
</span><span id="Stream-244"><a href="#Stream-244"><span class="linenos">244</span></a>            <span class="n">time_delta</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="Stream-245"><a href="#Stream-245"><span class="linenos">245</span></a>            <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">/</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">+</span> \
</span><span id="Stream-246"><a href="#Stream-246"><span class="linenos">246</span></a>                   <span class="n">time_delta</span>
</span><span id="Stream-247"><a href="#Stream-247"><span class="linenos">247</span></a>
</span><span id="Stream-248"><a href="#Stream-248"><span class="linenos">248</span></a>            <span class="k">for</span> <span class="n">arrival</span> <span class="ow">in</span> <span class="n">origin</span><span class="o">.</span><span class="n">arrivals</span><span class="p">:</span>
</span><span id="Stream-249"><a href="#Stream-249"><span class="linenos">249</span></a>                <span class="k">if</span> <span class="n">arrival</span><span class="o">.</span><span class="n">get_pick</span><span class="p">()</span><span class="o">.</span><span class="n">waveform_id</span><span class="o">.</span><span class="n">station_code</span> <span class="o">==</span> <span class="n">station_code</span><span class="p">:</span>
</span><span id="Stream-250"><a href="#Stream-250"><span class="linenos">250</span></a>                    <span class="n">distance</span> <span class="o">=</span> <span class="n">arrival</span><span class="o">.</span><span class="n">distance</span>
</span><span id="Stream-251"><a href="#Stream-251"><span class="linenos">251</span></a>
</span><span id="Stream-252"><a href="#Stream-252"><span class="linenos">252</span></a>                    <span class="k">if</span> <span class="n">arrival</span><span class="o">.</span><span class="n">phase</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span>
</span><span id="Stream-253"><a href="#Stream-253"><span class="linenos">253</span></a>                        <span class="n">p_pick</span> <span class="o">=</span> <span class="n">arrival</span><span class="o">.</span><span class="n">get_pick</span><span class="p">()</span><span class="o">.</span><span class="n">time</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="Stream-254"><a href="#Stream-254"><span class="linenos">254</span></a>                    <span class="k">elif</span> <span class="n">arrival</span><span class="o">.</span><span class="n">phase</span> <span class="o">==</span> <span class="s1">&#39;S&#39;</span><span class="p">:</span>
</span><span id="Stream-255"><a href="#Stream-255"><span class="linenos">255</span></a>                        <span class="n">s_pick</span> <span class="o">=</span> <span class="n">arrival</span><span class="o">.</span><span class="n">get_pick</span><span class="p">()</span><span class="o">.</span><span class="n">time</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="Stream-256"><a href="#Stream-256"><span class="linenos">256</span></a>
</span><span id="Stream-257"><a href="#Stream-257"><span class="linenos">257</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span> <span class="o">+</span> <span class="n">distance</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span><span id="Stream-258"><a href="#Stream-258"><span class="linenos">258</span></a>
</span><span id="Stream-259"><a href="#Stream-259"><span class="linenos">259</span></a>            <span class="k">if</span> <span class="n">p_pick</span><span class="p">:</span>
</span><span id="Stream-260"><a href="#Stream-260"><span class="linenos">260</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">p_pick</span><span class="p">,</span> <span class="n">distance</span> <span class="o">-</span> <span class="n">scale</span><span class="p">,</span> <span class="n">distance</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="Stream-261"><a href="#Stream-261"><span class="linenos">261</span></a>
</span><span id="Stream-262"><a href="#Stream-262"><span class="linenos">262</span></a>            <span class="k">if</span> <span class="n">s_pick</span><span class="p">:</span>
</span><span id="Stream-263"><a href="#Stream-263"><span class="linenos">263</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">s_pick</span><span class="p">,</span> <span class="n">distance</span> <span class="o">-</span> <span class="n">scale</span><span class="p">,</span> <span class="n">distance</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span><span id="Stream-264"><a href="#Stream-264"><span class="linenos">264</span></a>
</span><span id="Stream-265"><a href="#Stream-265"><span class="linenos">265</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;relative time (s)&#39;</span><span class="p">)</span>
</span><span id="Stream-266"><a href="#Stream-266"><span class="linenos">266</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;distance from event (m)&#39;</span><span class="p">)</span>
</span><span id="Stream-267"><a href="#Stream-267"><span class="linenos">267</span></a>
</span><span id="Stream-268"><a href="#Stream-268"><span class="linenos">268</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stream-269"><a href="#Stream-269"><span class="linenos">269</span></a>    <span class="k">def</span> <span class="nf">create_from_json_traces</span><span class="p">(</span><span class="n">traces_json_list</span><span class="p">):</span>
</span><span id="Stream-270"><a href="#Stream-270"><span class="linenos">270</span></a>        <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stream-271"><a href="#Stream-271"><span class="linenos">271</span></a>        <span class="c1"># for tr_json in traces_json_list:</span>
</span><span id="Stream-272"><a href="#Stream-272"><span class="linenos">272</span></a>
</span><span id="Stream-273"><a href="#Stream-273"><span class="linenos">273</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tr_json</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">traces_json_list</span><span class="p">):</span>
</span><span id="Stream-274"><a href="#Stream-274"><span class="linenos">274</span></a>            <span class="n">stats</span> <span class="o">=</span> <span class="n">tr_json</span><span class="p">[</span><span class="s1">&#39;stats&#39;</span><span class="p">]</span>
</span><span id="Stream-275"><a href="#Stream-275"><span class="linenos">275</span></a>            <span class="n">tr</span> <span class="o">=</span> <span class="n">Trace</span><span class="o">.</span><span class="n">create_from_json</span><span class="p">(</span><span class="n">tr_json</span><span class="p">)</span>
</span><span id="Stream-276"><a href="#Stream-276"><span class="linenos">276</span></a>            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tr</span><span class="p">)</span>
</span><span id="Stream-277"><a href="#Stream-277"><span class="linenos">277</span></a>
</span><span id="Stream-278"><a href="#Stream-278"><span class="linenos">278</span></a>        <span class="k">return</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="n">traces</span><span class="p">)</span>
</span><span id="Stream-279"><a href="#Stream-279"><span class="linenos">279</span></a>
</span><span id="Stream-280"><a href="#Stream-280"><span class="linenos">280</span></a>    <span class="k">def</span> <span class="nf">to_traces_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream-281"><a href="#Stream-281"><span class="linenos">281</span></a>        <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stream-282"><a href="#Stream-282"><span class="linenos">282</span></a>
</span><span id="Stream-283"><a href="#Stream-283"><span class="linenos">283</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Stream-284"><a href="#Stream-284"><span class="linenos">284</span></a>            <span class="n">trout</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</span><span id="Stream-285"><a href="#Stream-285"><span class="linenos">285</span></a>            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trout</span><span class="p">)</span>
</span><span id="Stream-286"><a href="#Stream-286"><span class="linenos">286</span></a>
</span><span id="Stream-287"><a href="#Stream-287"><span class="linenos">287</span></a>        <span class="k">return</span> <span class="n">traces</span>
</span><span id="Stream-288"><a href="#Stream-288"><span class="linenos">288</span></a>
</span><span id="Stream-289"><a href="#Stream-289"><span class="linenos">289</span></a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Stream-290"><a href="#Stream-290"><span class="linenos">290</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stream-291"><a href="#Stream-291"><span class="linenos">291</span></a><span class="sd">        see Obspy stream.plot()</span>
</span><span id="Stream-292"><a href="#Stream-292"><span class="linenos">292</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stream-293"><a href="#Stream-293"><span class="linenos">293</span></a>        <span class="kn">from</span> <span class="nn">..imaging.waveform</span> <span class="kn">import</span> <span class="n">WaveformPlotting</span>
</span><span id="Stream-294"><a href="#Stream-294"><span class="linenos">294</span></a>        <span class="n">waveform</span> <span class="o">=</span> <span class="n">WaveformPlotting</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Stream-295"><a href="#Stream-295"><span class="linenos">295</span></a>
</span><span id="Stream-296"><a href="#Stream-296"><span class="linenos">296</span></a>        <span class="k">return</span> <span class="n">waveform</span><span class="o">.</span><span class="n">plotWaveform</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>List like object of multiple ObsPy <code>~<a href="trace.html#Trace">uquake.core.trace.Trace</a></code>
objects.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>traces</strong>:  Initial list of ObsPy <code>~<a href="trace.html#Trace">uquake.core.trace.Trace</a></code>
objects.</li>
</ul>

<p>.. rubric:: Basic Usage</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">trace1</span> <span class="o">=</span> <span class="n">Trace</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trace2</span> <span class="o">=</span> <span class="n">Trace</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stream</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="p">[</span><span class="n">trace1</span><span class="p">,</span> <span class="n">trace2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>  <span class="c1"># doctest: +ELLIPSIS</span>
<span class="go">2 Trace(s) in Stream:</span>
<span class="go">...</span>
</code></pre>
</div>

<p>.. rubric:: Supported Operations</p>

<p><code>stream = streamA + streamB</code>
    Merges all traces within the two Stream objects <code>streamA</code> and
    <code>streamB</code> into the new Stream object <code>stream</code>.
    See also: <code>Stream.__add__()</code>.
<code>stream += streamA</code>
    Extends the Stream object <code>stream</code> with all traces from <code>streamA</code>.
    See also: <code>Stream.__iadd__()</code>.
<code>len(stream)</code>
    Returns the number of Traces in the Stream object <code>stream</code>.
    See also: <code>Stream.__len__()</code>.
<code>str(stream)</code>
    Contains the number of traces in the Stream object and returns the
    value of each Trace's __str__ method.
    See also: <code>Stream.__str__()</code>.</p>
</div>


                            <div id="Stream.__init__" class="classattr">
                                        <input id="Stream.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Stream</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">stream</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Stream.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.__init__-51"><a href="#Stream.__init__-51"><span class="linenos">51</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Stream.__init__-52"><a href="#Stream.__init__-52"><span class="linenos">52</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Stream</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Stream.__init__-53"><a href="#Stream.__init__-53"><span class="linenos">53</span></a>
</span><span id="Stream.__init__-54"><a href="#Stream.__init__-54"><span class="linenos">54</span></a>        <span class="k">if</span> <span class="n">stream</span><span class="p">:</span>
</span><span id="Stream.__init__-55"><a href="#Stream.__init__-55"><span class="linenos">55</span></a>            <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stream.__init__-56"><a href="#Stream.__init__-56"><span class="linenos">56</span></a>
</span><span id="Stream.__init__-57"><a href="#Stream.__init__-57"><span class="linenos">57</span></a>            <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">traces</span><span class="p">:</span>
</span><span id="Stream.__init__-58"><a href="#Stream.__init__-58"><span class="linenos">58</span></a>                <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Trace</span><span class="p">(</span><span class="n">trace</span><span class="o">=</span><span class="n">tr</span><span class="p">))</span>
</span><span id="Stream.__init__-59"><a href="#Stream.__init__-59"><span class="linenos">59</span></a>
</span><span id="Stream.__init__-60"><a href="#Stream.__init__-60"><span class="linenos">60</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="n">traces</span>
</span></pre></div>


    

                            </div>
                            <div id="Stream.composite" class="classattr">
                                        <input id="Stream.composite-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">composite</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.composite-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.composite"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.composite-62"><a href="#Stream.composite-62"><span class="linenos">62</span></a>    <span class="k">def</span> <span class="nf">composite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream.composite-63"><a href="#Stream.composite-63"><span class="linenos">63</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stream.composite-64"><a href="#Stream.composite-64"><span class="linenos">64</span></a><span class="sd">        returns a new stream object containing composite trace for all station.</span>
</span><span id="Stream.composite-65"><a href="#Stream.composite-65"><span class="linenos">65</span></a><span class="sd">        The amplitude of the composite traces are the norm of the amplitude of</span>
</span><span id="Stream.composite-66"><a href="#Stream.composite-66"><span class="linenos">66</span></a><span class="sd">        the trace of all component and the phase of the trace (sign) is the</span>
</span><span id="Stream.composite-67"><a href="#Stream.composite-67"><span class="linenos">67</span></a><span class="sd">        sign of the first components of a given station.</span>
</span><span id="Stream.composite-68"><a href="#Stream.composite-68"><span class="linenos">68</span></a><span class="sd">        :param st: a stream object</span>
</span><span id="Stream.composite-69"><a href="#Stream.composite-69"><span class="linenos">69</span></a><span class="sd">        :type st: ~uquake.core.stream.Stream</span>
</span><span id="Stream.composite-70"><a href="#Stream.composite-70"><span class="linenos">70</span></a><span class="sd">        :rtype: ~uquake.core.stream.Stream</span>
</span><span id="Stream.composite-71"><a href="#Stream.composite-71"><span class="linenos">71</span></a>
</span><span id="Stream.composite-72"><a href="#Stream.composite-72"><span class="linenos">72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stream.composite-73"><a href="#Stream.composite-73"><span class="linenos">73</span></a>
</span><span id="Stream.composite-74"><a href="#Stream.composite-74"><span class="linenos">74</span></a>        <span class="k">return</span> <span class="n">composite_traces</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>returns a new stream object containing composite trace for all station.
The amplitude of the composite traces are the norm of the amplitude of
the trace of all component and the phase of the trace (sign) is the
sign of the first components of a given station.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>st</strong>:  a stream object</li>
</ul>
</div>


                            </div>
                            <div id="Stream.select" class="classattr">
                                        <input id="Stream.select-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">select</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.select-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.select"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.select-76"><a href="#Stream.select-76"><span class="linenos">76</span></a>    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Stream.select-77"><a href="#Stream.select-77"><span class="linenos">77</span></a>        <span class="k">if</span> <span class="s1">&#39;location&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Stream.select-78"><a href="#Stream.select-78"><span class="linenos">78</span></a>            <span class="n">trs</span> <span class="o">=</span> <span class="p">[</span><span class="n">tr</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]]</span>
</span><span id="Stream.select-79"><a href="#Stream.select-79"><span class="linenos">79</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Stream.select-80"><a href="#Stream.select-80"><span class="linenos">80</span></a>            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Stream.select-81"><a href="#Stream.select-81"><span class="linenos">81</span></a>
</span><span id="Stream.select-82"><a href="#Stream.select-82"><span class="linenos">82</span></a>        <span class="n">st_tmp</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="n">trs</span><span class="p">)</span>
</span><span id="Stream.select-83"><a href="#Stream.select-83"><span class="linenos">83</span></a>
</span><span id="Stream.select-84"><a href="#Stream.select-84"><span class="linenos">84</span></a>        <span class="n">kwargs_tmp</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Stream.select-85"><a href="#Stream.select-85"><span class="linenos">85</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Stream.select-86"><a href="#Stream.select-86"><span class="linenos">86</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span>
</span><span id="Stream.select-87"><a href="#Stream.select-87"><span class="linenos">87</span></a>                <span class="k">continue</span>
</span><span id="Stream.select-88"><a href="#Stream.select-88"><span class="linenos">88</span></a>            <span class="n">kwargs_tmp</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="Stream.select-89"><a href="#Stream.select-89"><span class="linenos">89</span></a>
</span><span id="Stream.select-90"><a href="#Stream.select-90"><span class="linenos">90</span></a>        <span class="k">return</span> <span class="n">st_tmp</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs_tmp</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return new Stream object only with these traces that match the given
stats criteria (e.g. all traces with <code>channel="EHZ"</code>).</p>

<p>Alternatively, traces can be selected based on the content of an
<code>~obspy.core.inventory.inventory.Inventory</code> object: trace will
be selected if the inventory contains a matching channel active at the
trace start time.</p>

<p>.. rubric:: Examples</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">obspy</span> <span class="kn">import</span> <span class="n">read</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">station</span><span class="o">=</span><span class="s2">&quot;R*&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">)</span>  <span class="c1"># doctest: +ELLIPSIS</span>
<span class="go">3 Trace(s) in Stream:</span>
<span class="go">BW.RJOB..EHZ | 2009-08-24T00:20:03.000000Z ... | 100.0 Hz, 3000 samples</span>
<span class="go">BW.RJOB..EHN | 2009-08-24T00:20:03.000000Z ... | 100.0 Hz, 3000 samples</span>
<span class="go">BW.RJOB..EHE | 2009-08-24T00:20:03.000000Z ... | 100.0 Hz, 3000 samples</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">st2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;BW.RJOB..EHZ&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">)</span>  <span class="c1"># doctest: +ELLIPSIS</span>
<span class="go">1 Trace(s) in Stream:</span>
<span class="go">BW.RJOB..EHZ | 2009-08-24T00:20:03.000000Z ... | 100.0 Hz, 3000 samples</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">st2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">)</span>  <span class="c1"># doctest: +ELLIPSIS</span>
<span class="go">1 Trace(s) in Stream:</span>
<span class="go">BW.RJOB..EHZ | 2009-08-24T00:20:03.000000Z ... | 100.0 Hz, 3000 samples</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">st2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="s2">&quot;CZ&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">)</span>  <span class="c1"># doctest: +NORMALIZE_WHITESPACE</span>
<span class="go">0 Trace(s) in Stream:</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">obspy</span> <span class="kn">import</span> <span class="n">read_inventory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inv</span> <span class="o">=</span> <span class="n">read_inventory</span><span class="p">(</span><span class="s1">&#39;/path/to/BW_RJOB__EHZ.xml&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span>  <span class="c1"># doctest: +NORMALIZE_WHITESPACE</span>
<span class="go">Inventory created at 2013-12-07T18:00:42.878000Z</span>
<span class="go">        Created by: fdsn-stationxml-converter/1.0.0</span>
<span class="go">                    http://www.iris.edu/fdsnstationconverter</span>
<span class="go">        Sending institution: Erdbebendienst Bayern</span>
<span class="go">        Contains:</span>
<span class="go">                Networks (1):</span>
<span class="go">                        BW</span>
<span class="go">                Stations (1):</span>
<span class="go">                        BW.RJOB (Jochberg, Bavaria, BW-Net)</span>
<span class="go">                Channels (1):</span>
<span class="go">                        BW.RJOB..EHZ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">inventory</span><span class="o">=</span><span class="n">inv</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">)</span>  <span class="c1"># doctest: +ELLIPSIS</span>
<span class="go">1 Trace(s) in Stream:</span>
<span class="go">BW.RJOB..EHZ | 2009-08-24T00:20:03.000000Z ... | 100.0 Hz, 3000 samples</span>
</code></pre>
</div>

<div class="pdoc-alert pdoc-alert-warning">

<p>A new Stream object is returned but the traces it contains are
just aliases to the traces of the original stream. Does not copy
the data but only passes a reference.</p>

</div>

<p>All keyword arguments except for <code>component</code> are tested directly
against the respective entry in the <code>~obspy.core.trace.Stats</code>
dictionary.</p>

<p>If a string for <code>component</code> is given (should be a single letter) it
is tested against the last letter of the <code>Trace.stats.channel</code> entry.</p>

<p>Alternatively, <code>channel</code> may have the last one or two letters
wildcarded (e.g. <code>channel="EH*"</code>) to select all components with a
common band/instrument code.</p>

<p>All other selection criteria that accept strings (network, station,
location) may also contain Unix style wildcards (<code>*</code>, <code>?</code>, ...).</p>
</div>


                            </div>
                            <div id="Stream.as_array" class="classattr">
                                        <input id="Stream.as_array-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_array</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">wlen_sec</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">taplen</span><span class="o">=</span><span class="mf">0.05</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.as_array-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.as_array"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.as_array-92"><a href="#Stream.as_array-92"><span class="linenos"> 92</span></a>    <span class="k">def</span> <span class="nf">as_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wlen_sec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">taplen</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
</span><span id="Stream.as_array-93"><a href="#Stream.as_array-93"><span class="linenos"> 93</span></a>        <span class="n">t0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>
</span><span id="Stream.as_array-94"><a href="#Stream.as_array-94"><span class="linenos"> 94</span></a>        <span class="n">sr</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>
</span><span id="Stream.as_array-95"><a href="#Stream.as_array-95"><span class="linenos"> 95</span></a>
</span><span id="Stream.as_array-96"><a href="#Stream.as_array-96"><span class="linenos"> 96</span></a>        <span class="k">if</span> <span class="n">wlen_sec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Stream.as_array-97"><a href="#Stream.as_array-97"><span class="linenos"> 97</span></a>            <span class="n">npts_fix</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">wlen_sec</span> <span class="o">*</span> <span class="n">sr</span><span class="p">)</span>
</span><span id="Stream.as_array-98"><a href="#Stream.as_array-98"><span class="linenos"> 98</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Stream.as_array-99"><a href="#Stream.as_array-99"><span class="linenos"> 99</span></a>            <span class="n">npts_fix</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]))</span>
</span><span id="Stream.as_array-100"><a href="#Stream.as_array-100"><span class="linenos">100</span></a>
</span><span id="Stream.as_array-101"><a href="#Stream.as_array-101"><span class="linenos">101</span></a>        <span class="k">return</span> <span class="n">tools</span><span class="o">.</span><span class="n">stream_to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">npts_fix</span><span class="p">,</span> <span class="n">taplen</span><span class="o">=</span><span class="n">taplen</span><span class="p">),</span> <span class="n">sr</span><span class="p">,</span> <span class="n">t0</span>
</span></pre></div>


    

                            </div>
                            <div id="Stream.chan_groups" class="classattr">
                                        <input id="Stream.chan_groups-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">chan_groups</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.chan_groups-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.chan_groups"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.chan_groups-103"><a href="#Stream.chan_groups-103"><span class="linenos">103</span></a>    <span class="k">def</span> <span class="nf">chan_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream.chan_groups-104"><a href="#Stream.chan_groups-104"><span class="linenos">104</span></a>        <span class="n">chanmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_map</span><span class="p">()</span>
</span><span id="Stream.chan_groups-105"><a href="#Stream.chan_groups-105"><span class="linenos">105</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sk</span> <span class="o">==</span> <span class="n">chanmap</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">sk</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">chanmap</span><span class="p">)]</span>
</span><span id="Stream.chan_groups-106"><a href="#Stream.chan_groups-106"><span class="linenos">106</span></a>
</span><span id="Stream.chan_groups-107"><a href="#Stream.chan_groups-107"><span class="linenos">107</span></a>        <span class="k">return</span> <span class="n">groups</span>
</span></pre></div>


    

                            </div>
                            <div id="Stream.channel_map" class="classattr">
                                        <input id="Stream.channel_map-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">channel_map</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.channel_map-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.channel_map"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.channel_map-109"><a href="#Stream.channel_map-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="nf">channel_map</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream.channel_map-110"><a href="#Stream.channel_map-110"><span class="linenos">110</span></a>        <span class="n">stations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span> <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>
</span><span id="Stream.channel_map-111"><a href="#Stream.channel_map-111"><span class="linenos">111</span></a>        <span class="n">unique</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">stations</span><span class="p">)</span>
</span><span id="Stream.channel_map-112"><a href="#Stream.channel_map-112"><span class="linenos">112</span></a>        <span class="n">unique_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique</span><span class="p">))))</span>
</span><span id="Stream.channel_map-113"><a href="#Stream.channel_map-113"><span class="linenos">113</span></a>        <span class="n">chanmap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">unique_dict</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span><span id="Stream.channel_map-114"><a href="#Stream.channel_map-114"><span class="linenos">114</span></a>
</span><span id="Stream.channel_map-115"><a href="#Stream.channel_map-115"><span class="linenos">115</span></a>        <span class="k">return</span> <span class="n">chanmap</span>
</span></pre></div>


    

                            </div>
                            <div id="Stream.write" class="classattr">
                                        <input id="Stream.write-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filename</span>, </span><span class="param"><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;MSEED&#39;</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.write-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.write"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.write-117"><a href="#Stream.write-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;MSEED&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Stream.write-118"><a href="#Stream.write-118"><span class="linenos">118</span></a>
</span><span id="Stream.write-119"><a href="#Stream.write-119"><span class="linenos">119</span></a>        <span class="kn">from</span> <span class="nn">six</span> <span class="kn">import</span> <span class="n">string_types</span>
</span><span id="Stream.write-120"><a href="#Stream.write-120"><span class="linenos">120</span></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">filename</span>
</span><span id="Stream.write-121"><a href="#Stream.write-121"><span class="linenos">121</span></a>
</span><span id="Stream.write-122"><a href="#Stream.write-122"><span class="linenos">122</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
</span><span id="Stream.write-123"><a href="#Stream.write-123"><span class="linenos">123</span></a>            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;gz&#39;</span><span class="p">):</span>
</span><span id="Stream.write-124"><a href="#Stream.write-124"><span class="linenos">124</span></a>                <span class="kn">import</span> <span class="nn">gzip</span>
</span><span id="Stream.write-125"><a href="#Stream.write-125"><span class="linenos">125</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="Stream.write-126"><a href="#Stream.write-126"><span class="linenos">126</span></a>            <span class="k">elif</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;bz2&#39;</span><span class="p">):</span>
</span><span id="Stream.write-127"><a href="#Stream.write-127"><span class="linenos">127</span></a>                <span class="kn">import</span> <span class="nn">bz2</span>
</span><span id="Stream.write-128"><a href="#Stream.write-128"><span class="linenos">128</span></a>                <span class="n">f</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">BZ2File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="Stream.write-129"><a href="#Stream.write-129"><span class="linenos">129</span></a>            <span class="k">elif</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;zip&#39;</span><span class="p">):</span>
</span><span id="Stream.write-130"><a href="#Stream.write-130"><span class="linenos">130</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Zip protocol is not supported&#39;</span><span class="p">)</span>
</span><span id="Stream.write-131"><a href="#Stream.write-131"><span class="linenos">131</span></a>
</span><span id="Stream.write-132"><a href="#Stream.write-132"><span class="linenos">132</span></a>        <span class="n">st_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Stream.write-133"><a href="#Stream.write-133"><span class="linenos">133</span></a>
</span><span id="Stream.write-134"><a href="#Stream.write-134"><span class="linenos">134</span></a>        <span class="k">return</span> <span class="n">obsstream</span><span class="o">.</span><span class="n">Stream</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">st_out</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Save stream into a file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>filename</strong>:  The name of the file to write.</li>
<li><strong>format</strong>:  The file format to use (e.g. <code>"MSEED"</code>). See
the <code>Supported Formats</code>_ section below for a list of supported
formats. If format is set to <code>None</code> it will be deduced from
file extension, whenever possible.</li>
<li><strong>kwargs</strong>:  Additional keyword arguments passed to the underlying
waveform writer method.</li>
</ul>

<p>.. rubric:: Example</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">uquake</span> <span class="kn">import</span> <span class="n">read</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">read</span><span class="p">()</span>  <span class="c1"># doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;example.mseed&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;MSEED&quot;</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
</code></pre>
</div>

<p>The <code>format</code> argument can be omitted, and the file format will be
deduced from file extension, whenever possible.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;example.mseed&quot;</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
</code></pre>
</div>

<p>Writing single traces into files with meaningful filenames can be done
e.g. using trace.id</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st</span><span class="p">:</span> <span class="c1">#doctest: +SKIP</span>
<span class="gp">... </span>    <span class="n">tr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="s2">&quot;.MSEED&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;MSEED&quot;</span><span class="p">)</span> <span class="c1">#doctest: +SKIP</span>
</code></pre>
</div>

<p>.. rubric:: _<code>Supported Formats</code></p>

<p>Additional ObsPy modules extend the parameters of the
<code>~<a href="#Stream.write">Stream.write()</a></code> method. The following
table summarizes all known formats currently available for ObsPy.</p>

<p>Please refer to the <code>Linked Function Call</code>_ of each module for any
extra options available.</p>

<p>====== ======================== =========================================
Format Used Module              _<code>Linked Function Call</code> <br />
====== ======================== =========================================
AH     <code>uquake.io.ah</code>       <code>uquake.io.ah.core._write_ah1()</code> <br />
GCF    <code>uquake.io.gcf</code>      <code>uquake.io.gcf.core._write_gcf()</code> <br />
GSE2   <code>uquake.io.gse2</code>     <code>uquake.io.gse2.core._write_gse2()</code> <br />
MSEED  <code>uquake.io.mseed</code>    <code>uquake.io.mseed.core._write_mseed()</code> 
PICKLE <code><a href="">uquake.core.stream</a></code> <code>uquake.core.stream._write_pickle()</code> <br />
Q      <code>uquake.io.sh</code>       <code>uquake.io.sh.core._write_q()</code> <br />
SAC    <code>uquake.io.sac</code>      <code>uquake.io.sac.core._write_sac()</code> <br />
SACXY  <code>uquake.io.sac</code>      <code>uquake.io.sac.core._write_sac_xy()</code> <br />
SEGY   <code>uquake.io.segy</code>     <code>uquake.io.segy.core._write_segy()</code> <br />
SH_ASC <code>uquake.io.sh</code>       <code>uquake.io.sh.core._write_asc()</code> <br />
SLIST  <code>uquake.io.ascii</code>    <code>uquake.io.ascii.core._write_slist()</code> 
SU     <code>uquake.io.segy</code>     <code>uquake.io.segy.core._write_su()</code> <br />
TSPAIR <code>uquake.io.ascii</code>    <code>uquake.io.ascii.core._write_tspair()</code>
WAV    <code>uquake.io.wav</code>      <code>uquake.io.wav.core._write_wav()</code> <br />
====== ======================== =========================================</p>
</div>


                            </div>
                            <div id="Stream.write_bytes" class="classattr">
                                        <input id="Stream.write_bytes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_bytes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.write_bytes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.write_bytes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.write_bytes-139"><a href="#Stream.write_bytes-139"><span class="linenos">139</span></a>    <span class="k">def</span> <span class="nf">write_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream.write_bytes-140"><a href="#Stream.write_bytes-140"><span class="linenos">140</span></a>        <span class="n">buf</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span><span id="Stream.write_bytes-141"><a href="#Stream.write_bytes-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;MSEED&#39;</span><span class="p">)</span>
</span><span id="Stream.write_bytes-142"><a href="#Stream.write_bytes-142"><span class="linenos">142</span></a>
</span><span id="Stream.write_bytes-143"><a href="#Stream.write_bytes-143"><span class="linenos">143</span></a>        <span class="k">return</span> <span class="n">buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="Stream.valid" class="classattr">
                                        <input id="Stream.valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.valid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.valid-145"><a href="#Stream.valid-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Stream.valid-146"><a href="#Stream.valid-146"><span class="linenos">146</span></a>        <span class="k">return</span> <span class="n">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Stream.concat" class="classattr">
                                        <input id="Stream.concat-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">concat</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">comp_st</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.concat-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.concat"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.concat-148"><a href="#Stream.concat-148"><span class="linenos">148</span></a>    <span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comp_st</span><span class="p">):</span>
</span><span id="Stream.concat-149"><a href="#Stream.concat-149"><span class="linenos">149</span></a>
</span><span id="Stream.concat-150"><a href="#Stream.concat-150"><span class="linenos">150</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">comp_st</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="Stream.concat-151"><a href="#Stream.concat-151"><span class="linenos">151</span></a>
</span><span id="Stream.concat-152"><a href="#Stream.concat-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="n">c</span><span class="p">:</span>
</span><span id="Stream.concat-153"><a href="#Stream.concat-153"><span class="linenos">153</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">comp_st</span><span class="o">.</span><span class="n">traces</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">)):</span>
</span><span id="Stream.concat-154"><a href="#Stream.concat-154"><span class="linenos">154</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">detrend_norm</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
</span><span id="Stream.concat-155"><a href="#Stream.concat-155"><span class="linenos">155</span></a>                <span class="n">comp_st</span><span class="o">.</span><span class="n">traces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Stream.concat-156"><a href="#Stream.concat-156"><span class="linenos">156</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Stream.concat-157"><a href="#Stream.concat-157"><span class="linenos">157</span></a>            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Stream.concat-158"><a href="#Stream.concat-158"><span class="linenos">158</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">detrend_norm</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="Stream.concat-159"><a href="#Stream.concat-159"><span class="linenos">159</span></a>
</span><span id="Stream.concat-160"><a href="#Stream.concat-160"><span class="linenos">160</span></a>            <span class="n">comp_st</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Stream.concat-161"><a href="#Stream.concat-161"><span class="linenos">161</span></a>
</span><span id="Stream.concat-162"><a href="#Stream.concat-162"><span class="linenos">162</span></a>        <span class="k">return</span> <span class="n">comp_st</span>
</span></pre></div>


    

                            </div>
                            <div id="Stream.unique_stations" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_stations</span>

        
    </div>
    <a class="headerlink" href="#Stream.unique_stations"></a>
    
    

                            </div>
                            <div id="Stream.unique_instruments" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_instruments</span>

        
    </div>
    <a class="headerlink" href="#Stream.unique_instruments"></a>
    
    

                            </div>
                            <div id="Stream.stations" class="classattr">
                                <div class="attr variable">
            <span class="name">stations</span>

        
    </div>
    <a class="headerlink" href="#Stream.stations"></a>
    
    

                            </div>
                            <div id="Stream.instruments" class="classattr">
                                <div class="attr variable">
            <span class="name">instruments</span>

        
    </div>
    <a class="headerlink" href="#Stream.instruments"></a>
    
    

                            </div>
                            <div id="Stream.zpad_names" class="classattr">
                                        <input id="Stream.zpad_names-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">zpad_names</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.zpad_names-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.zpad_names"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.zpad_names-180"><a href="#Stream.zpad_names-180"><span class="linenos">180</span></a>    <span class="k">def</span> <span class="nf">zpad_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream.zpad_names-181"><a href="#Stream.zpad_names-181"><span class="linenos">181</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">:</span>
</span><span id="Stream.zpad_names-182"><a href="#Stream.zpad_names-182"><span class="linenos">182</span></a>            <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="Stream.zpad_names-183"><a href="#Stream.zpad_names-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="Stream.zstrip_names" class="classattr">
                                        <input id="Stream.zstrip_names-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">zstrip_names</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.zstrip_names-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.zstrip_names"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.zstrip_names-185"><a href="#Stream.zstrip_names-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">zstrip_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream.zstrip_names-186"><a href="#Stream.zstrip_names-186"><span class="linenos">186</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">:</span>
</span><span id="Stream.zstrip_names-187"><a href="#Stream.zstrip_names-187"><span class="linenos">187</span></a>            <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Stream.distance_time_plot" class="classattr">
                                        <input id="Stream.distance_time_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">distance_time_plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">event</span>, </span><span class="param"><span class="n">location</span>, </span><span class="param"><span class="n">scale</span><span class="o">=</span><span class="mi">20</span>, </span><span class="param"><span class="n">freq_min</span><span class="o">=</span><span class="mi">100</span>, </span><span class="param"><span class="n">freq_max</span><span class="o">=</span><span class="mi">1000</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.distance_time_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.distance_time_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.distance_time_plot-189"><a href="#Stream.distance_time_plot-189"><span class="linenos">189</span></a>    <span class="k">def</span> <span class="nf">distance_time_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">freq_min</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="Stream.distance_time_plot-190"><a href="#Stream.distance_time_plot-190"><span class="linenos">190</span></a>                           <span class="n">freq_max</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
</span><span id="Stream.distance_time_plot-191"><a href="#Stream.distance_time_plot-191"><span class="linenos">191</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stream.distance_time_plot-192"><a href="#Stream.distance_time_plot-192"><span class="linenos">192</span></a><span class="sd">        plot traces that have</span>
</span><span id="Stream.distance_time_plot-193"><a href="#Stream.distance_time_plot-193"><span class="linenos">193</span></a><span class="sd">        :param event: event object</span>
</span><span id="Stream.distance_time_plot-194"><a href="#Stream.distance_time_plot-194"><span class="linenos">194</span></a><span class="sd">        :param location: location object</span>
</span><span id="Stream.distance_time_plot-195"><a href="#Stream.distance_time_plot-195"><span class="linenos">195</span></a><span class="sd">        :param scale: vertical size of pick markers and waveform</span>
</span><span id="Stream.distance_time_plot-196"><a href="#Stream.distance_time_plot-196"><span class="linenos">196</span></a><span class="sd">        :return: plot handler</span>
</span><span id="Stream.distance_time_plot-197"><a href="#Stream.distance_time_plot-197"><span class="linenos">197</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stream.distance_time_plot-198"><a href="#Stream.distance_time_plot-198"><span class="linenos">198</span></a>
</span><span id="Stream.distance_time_plot-199"><a href="#Stream.distance_time_plot-199"><span class="linenos">199</span></a>        <span class="n">st</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Stream.distance_time_plot-200"><a href="#Stream.distance_time_plot-200"><span class="linenos">200</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s1">&#39;demean&#39;</span><span class="p">)</span>
</span><span id="Stream.distance_time_plot-201"><a href="#Stream.distance_time_plot-201"><span class="linenos">201</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">taper</span><span class="p">(</span><span class="n">max_percentage</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</span><span id="Stream.distance_time_plot-202"><a href="#Stream.distance_time_plot-202"><span class="linenos">202</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">freqmin</span><span class="o">=</span><span class="n">freq_min</span><span class="p">,</span> <span class="n">freqmax</span><span class="o">=</span><span class="n">freq_max</span><span class="p">)</span>
</span><span id="Stream.distance_time_plot-203"><a href="#Stream.distance_time_plot-203"><span class="linenos">203</span></a>
</span><span id="Stream.distance_time_plot-204"><a href="#Stream.distance_time_plot-204"><span class="linenos">204</span></a>        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="Stream.distance_time_plot-205"><a href="#Stream.distance_time_plot-205"><span class="linenos">205</span></a>        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="Stream.distance_time_plot-206"><a href="#Stream.distance_time_plot-206"><span class="linenos">206</span></a>
</span><span id="Stream.distance_time_plot-207"><a href="#Stream.distance_time_plot-207"><span class="linenos">207</span></a>        <span class="c1"># initializing the plot</span>
</span><span id="Stream.distance_time_plot-208"><a href="#Stream.distance_time_plot-208"><span class="linenos">208</span></a>
</span><span id="Stream.distance_time_plot-209"><a href="#Stream.distance_time_plot-209"><span class="linenos">209</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
</span><span id="Stream.distance_time_plot-210"><a href="#Stream.distance_time_plot-210"><span class="linenos">210</span></a>
</span><span id="Stream.distance_time_plot-211"><a href="#Stream.distance_time_plot-211"><span class="linenos">211</span></a>        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">preferred_origin</span><span class="p">():</span>
</span><span id="Stream.distance_time_plot-212"><a href="#Stream.distance_time_plot-212"><span class="linenos">212</span></a>            <span class="n">origin</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">preferred_origin</span><span class="p">()</span>
</span><span id="Stream.distance_time_plot-213"><a href="#Stream.distance_time_plot-213"><span class="linenos">213</span></a>        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">:</span>
</span><span id="Stream.distance_time_plot-214"><a href="#Stream.distance_time_plot-214"><span class="linenos">214</span></a>            <span class="n">origin</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Stream.distance_time_plot-215"><a href="#Stream.distance_time_plot-215"><span class="linenos">215</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Stream.distance_time_plot-216"><a href="#Stream.distance_time_plot-216"><span class="linenos">216</span></a>            <span class="k">return</span>
</span><span id="Stream.distance_time_plot-217"><a href="#Stream.distance_time_plot-217"><span class="linenos">217</span></a>
</span><span id="Stream.distance_time_plot-218"><a href="#Stream.distance_time_plot-218"><span class="linenos">218</span></a>        <span class="n">event_location</span> <span class="o">=</span> <span class="n">origin</span><span class="o">.</span><span class="n">loc</span>
</span><span id="Stream.distance_time_plot-219"><a href="#Stream.distance_time_plot-219"><span class="linenos">219</span></a>
</span><span id="Stream.distance_time_plot-220"><a href="#Stream.distance_time_plot-220"><span class="linenos">220</span></a>        <span class="c1"># find the earliest start time and latest end time</span>
</span><span id="Stream.distance_time_plot-221"><a href="#Stream.distance_time_plot-221"><span class="linenos">221</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Stream.distance_time_plot-222"><a href="#Stream.distance_time_plot-222"><span class="linenos">222</span></a>        <span class="n">end_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Stream.distance_time_plot-223"><a href="#Stream.distance_time_plot-223"><span class="linenos">223</span></a>
</span><span id="Stream.distance_time_plot-224"><a href="#Stream.distance_time_plot-224"><span class="linenos">224</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st</span><span class="p">:</span>
</span><span id="Stream.distance_time_plot-225"><a href="#Stream.distance_time_plot-225"><span class="linenos">225</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">start_time</span><span class="p">:</span>
</span><span id="Stream.distance_time_plot-226"><a href="#Stream.distance_time_plot-226"><span class="linenos">226</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span>
</span><span id="Stream.distance_time_plot-227"><a href="#Stream.distance_time_plot-227"><span class="linenos">227</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span>
</span><span id="Stream.distance_time_plot-228"><a href="#Stream.distance_time_plot-228"><span class="linenos">228</span></a>
</span><span id="Stream.distance_time_plot-229"><a href="#Stream.distance_time_plot-229"><span class="linenos">229</span></a>            <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="o">&lt;</span> <span class="n">start_time</span><span class="p">:</span>
</span><span id="Stream.distance_time_plot-230"><a href="#Stream.distance_time_plot-230"><span class="linenos">230</span></a>                <span class="n">start_time</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span>
</span><span id="Stream.distance_time_plot-231"><a href="#Stream.distance_time_plot-231"><span class="linenos">231</span></a>
</span><span id="Stream.distance_time_plot-232"><a href="#Stream.distance_time_plot-232"><span class="linenos">232</span></a>            <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span> <span class="o">&gt;</span> <span class="n">end_time</span><span class="p">:</span>
</span><span id="Stream.distance_time_plot-233"><a href="#Stream.distance_time_plot-233"><span class="linenos">233</span></a>                <span class="n">end_time</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span>
</span><span id="Stream.distance_time_plot-234"><a href="#Stream.distance_time_plot-234"><span class="linenos">234</span></a>
</span><span id="Stream.distance_time_plot-235"><a href="#Stream.distance_time_plot-235"><span class="linenos">235</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st</span><span class="p">:</span>
</span><span id="Stream.distance_time_plot-236"><a href="#Stream.distance_time_plot-236"><span class="linenos">236</span></a>            <span class="n">station_code</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span>
</span><span id="Stream.distance_time_plot-237"><a href="#Stream.distance_time_plot-237"><span class="linenos">237</span></a>            <span class="c1"># search for arrival</span>
</span><span id="Stream.distance_time_plot-238"><a href="#Stream.distance_time_plot-238"><span class="linenos">238</span></a>            <span class="n">station</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">station_code</span><span class="p">)</span><span class="o">.</span><span class="n">stations</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Stream.distance_time_plot-239"><a href="#Stream.distance_time_plot-239"><span class="linenos">239</span></a>            <span class="n">station_location</span> <span class="o">=</span> <span class="n">station</span><span class="o">.</span><span class="n">loc</span>
</span><span id="Stream.distance_time_plot-240"><a href="#Stream.distance_time_plot-240"><span class="linenos">240</span></a>            <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">event_location</span> <span class="o">-</span> <span class="n">station_location</span><span class="p">)</span>
</span><span id="Stream.distance_time_plot-241"><a href="#Stream.distance_time_plot-241"><span class="linenos">241</span></a>            <span class="n">p_pick</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Stream.distance_time_plot-242"><a href="#Stream.distance_time_plot-242"><span class="linenos">242</span></a>            <span class="n">s_pick</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Stream.distance_time_plot-243"><a href="#Stream.distance_time_plot-243"><span class="linenos">243</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span> <span class="o">*</span> <span class="n">scale</span>
</span><span id="Stream.distance_time_plot-244"><a href="#Stream.distance_time_plot-244"><span class="linenos">244</span></a>            <span class="n">time_delta</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="Stream.distance_time_plot-245"><a href="#Stream.distance_time_plot-245"><span class="linenos">245</span></a>            <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">/</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">+</span> \
</span><span id="Stream.distance_time_plot-246"><a href="#Stream.distance_time_plot-246"><span class="linenos">246</span></a>                   <span class="n">time_delta</span>
</span><span id="Stream.distance_time_plot-247"><a href="#Stream.distance_time_plot-247"><span class="linenos">247</span></a>
</span><span id="Stream.distance_time_plot-248"><a href="#Stream.distance_time_plot-248"><span class="linenos">248</span></a>            <span class="k">for</span> <span class="n">arrival</span> <span class="ow">in</span> <span class="n">origin</span><span class="o">.</span><span class="n">arrivals</span><span class="p">:</span>
</span><span id="Stream.distance_time_plot-249"><a href="#Stream.distance_time_plot-249"><span class="linenos">249</span></a>                <span class="k">if</span> <span class="n">arrival</span><span class="o">.</span><span class="n">get_pick</span><span class="p">()</span><span class="o">.</span><span class="n">waveform_id</span><span class="o">.</span><span class="n">station_code</span> <span class="o">==</span> <span class="n">station_code</span><span class="p">:</span>
</span><span id="Stream.distance_time_plot-250"><a href="#Stream.distance_time_plot-250"><span class="linenos">250</span></a>                    <span class="n">distance</span> <span class="o">=</span> <span class="n">arrival</span><span class="o">.</span><span class="n">distance</span>
</span><span id="Stream.distance_time_plot-251"><a href="#Stream.distance_time_plot-251"><span class="linenos">251</span></a>
</span><span id="Stream.distance_time_plot-252"><a href="#Stream.distance_time_plot-252"><span class="linenos">252</span></a>                    <span class="k">if</span> <span class="n">arrival</span><span class="o">.</span><span class="n">phase</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span>
</span><span id="Stream.distance_time_plot-253"><a href="#Stream.distance_time_plot-253"><span class="linenos">253</span></a>                        <span class="n">p_pick</span> <span class="o">=</span> <span class="n">arrival</span><span class="o">.</span><span class="n">get_pick</span><span class="p">()</span><span class="o">.</span><span class="n">time</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="Stream.distance_time_plot-254"><a href="#Stream.distance_time_plot-254"><span class="linenos">254</span></a>                    <span class="k">elif</span> <span class="n">arrival</span><span class="o">.</span><span class="n">phase</span> <span class="o">==</span> <span class="s1">&#39;S&#39;</span><span class="p">:</span>
</span><span id="Stream.distance_time_plot-255"><a href="#Stream.distance_time_plot-255"><span class="linenos">255</span></a>                        <span class="n">s_pick</span> <span class="o">=</span> <span class="n">arrival</span><span class="o">.</span><span class="n">get_pick</span><span class="p">()</span><span class="o">.</span><span class="n">time</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="Stream.distance_time_plot-256"><a href="#Stream.distance_time_plot-256"><span class="linenos">256</span></a>
</span><span id="Stream.distance_time_plot-257"><a href="#Stream.distance_time_plot-257"><span class="linenos">257</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span> <span class="o">+</span> <span class="n">distance</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span><span id="Stream.distance_time_plot-258"><a href="#Stream.distance_time_plot-258"><span class="linenos">258</span></a>
</span><span id="Stream.distance_time_plot-259"><a href="#Stream.distance_time_plot-259"><span class="linenos">259</span></a>            <span class="k">if</span> <span class="n">p_pick</span><span class="p">:</span>
</span><span id="Stream.distance_time_plot-260"><a href="#Stream.distance_time_plot-260"><span class="linenos">260</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">p_pick</span><span class="p">,</span> <span class="n">distance</span> <span class="o">-</span> <span class="n">scale</span><span class="p">,</span> <span class="n">distance</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="Stream.distance_time_plot-261"><a href="#Stream.distance_time_plot-261"><span class="linenos">261</span></a>
</span><span id="Stream.distance_time_plot-262"><a href="#Stream.distance_time_plot-262"><span class="linenos">262</span></a>            <span class="k">if</span> <span class="n">s_pick</span><span class="p">:</span>
</span><span id="Stream.distance_time_plot-263"><a href="#Stream.distance_time_plot-263"><span class="linenos">263</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">s_pick</span><span class="p">,</span> <span class="n">distance</span> <span class="o">-</span> <span class="n">scale</span><span class="p">,</span> <span class="n">distance</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span><span id="Stream.distance_time_plot-264"><a href="#Stream.distance_time_plot-264"><span class="linenos">264</span></a>
</span><span id="Stream.distance_time_plot-265"><a href="#Stream.distance_time_plot-265"><span class="linenos">265</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;relative time (s)&#39;</span><span class="p">)</span>
</span><span id="Stream.distance_time_plot-266"><a href="#Stream.distance_time_plot-266"><span class="linenos">266</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;distance from event (m)&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>plot traces that have</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event</strong>:  event object</li>
<li><strong>location</strong>:  location object</li>
<li><strong>scale</strong>:  vertical size of pick markers and waveform</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>plot handler</p>
</blockquote>
</div>


                            </div>
                            <div id="Stream.create_from_json_traces" class="classattr">
                                        <input id="Stream.create_from_json_traces-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">create_from_json_traces</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">traces_json_list</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.create_from_json_traces-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.create_from_json_traces"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.create_from_json_traces-268"><a href="#Stream.create_from_json_traces-268"><span class="linenos">268</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Stream.create_from_json_traces-269"><a href="#Stream.create_from_json_traces-269"><span class="linenos">269</span></a>    <span class="k">def</span> <span class="nf">create_from_json_traces</span><span class="p">(</span><span class="n">traces_json_list</span><span class="p">):</span>
</span><span id="Stream.create_from_json_traces-270"><a href="#Stream.create_from_json_traces-270"><span class="linenos">270</span></a>        <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stream.create_from_json_traces-271"><a href="#Stream.create_from_json_traces-271"><span class="linenos">271</span></a>        <span class="c1"># for tr_json in traces_json_list:</span>
</span><span id="Stream.create_from_json_traces-272"><a href="#Stream.create_from_json_traces-272"><span class="linenos">272</span></a>
</span><span id="Stream.create_from_json_traces-273"><a href="#Stream.create_from_json_traces-273"><span class="linenos">273</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tr_json</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">traces_json_list</span><span class="p">):</span>
</span><span id="Stream.create_from_json_traces-274"><a href="#Stream.create_from_json_traces-274"><span class="linenos">274</span></a>            <span class="n">stats</span> <span class="o">=</span> <span class="n">tr_json</span><span class="p">[</span><span class="s1">&#39;stats&#39;</span><span class="p">]</span>
</span><span id="Stream.create_from_json_traces-275"><a href="#Stream.create_from_json_traces-275"><span class="linenos">275</span></a>            <span class="n">tr</span> <span class="o">=</span> <span class="n">Trace</span><span class="o">.</span><span class="n">create_from_json</span><span class="p">(</span><span class="n">tr_json</span><span class="p">)</span>
</span><span id="Stream.create_from_json_traces-276"><a href="#Stream.create_from_json_traces-276"><span class="linenos">276</span></a>            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tr</span><span class="p">)</span>
</span><span id="Stream.create_from_json_traces-277"><a href="#Stream.create_from_json_traces-277"><span class="linenos">277</span></a>
</span><span id="Stream.create_from_json_traces-278"><a href="#Stream.create_from_json_traces-278"><span class="linenos">278</span></a>        <span class="k">return</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="n">traces</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Stream.to_traces_json" class="classattr">
                                        <input id="Stream.to_traces_json-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_traces_json</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.to_traces_json-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.to_traces_json"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.to_traces_json-280"><a href="#Stream.to_traces_json-280"><span class="linenos">280</span></a>    <span class="k">def</span> <span class="nf">to_traces_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Stream.to_traces_json-281"><a href="#Stream.to_traces_json-281"><span class="linenos">281</span></a>        <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Stream.to_traces_json-282"><a href="#Stream.to_traces_json-282"><span class="linenos">282</span></a>
</span><span id="Stream.to_traces_json-283"><a href="#Stream.to_traces_json-283"><span class="linenos">283</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Stream.to_traces_json-284"><a href="#Stream.to_traces_json-284"><span class="linenos">284</span></a>            <span class="n">trout</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</span><span id="Stream.to_traces_json-285"><a href="#Stream.to_traces_json-285"><span class="linenos">285</span></a>            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trout</span><span class="p">)</span>
</span><span id="Stream.to_traces_json-286"><a href="#Stream.to_traces_json-286"><span class="linenos">286</span></a>
</span><span id="Stream.to_traces_json-287"><a href="#Stream.to_traces_json-287"><span class="linenos">287</span></a>        <span class="k">return</span> <span class="n">traces</span>
</span></pre></div>


    

                            </div>
                            <div id="Stream.plot" class="classattr">
                                        <input id="Stream.plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Stream.plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Stream.plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Stream.plot-289"><a href="#Stream.plot-289"><span class="linenos">289</span></a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Stream.plot-290"><a href="#Stream.plot-290"><span class="linenos">290</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Stream.plot-291"><a href="#Stream.plot-291"><span class="linenos">291</span></a><span class="sd">        see Obspy stream.plot()</span>
</span><span id="Stream.plot-292"><a href="#Stream.plot-292"><span class="linenos">292</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Stream.plot-293"><a href="#Stream.plot-293"><span class="linenos">293</span></a>        <span class="kn">from</span> <span class="nn">..imaging.waveform</span> <span class="kn">import</span> <span class="n">WaveformPlotting</span>
</span><span id="Stream.plot-294"><a href="#Stream.plot-294"><span class="linenos">294</span></a>        <span class="n">waveform</span> <span class="o">=</span> <span class="n">WaveformPlotting</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Stream.plot-295"><a href="#Stream.plot-295"><span class="linenos">295</span></a>
</span><span id="Stream.plot-296"><a href="#Stream.plot-296"><span class="linenos">296</span></a>        <span class="k">return</span> <span class="n">waveform</span><span class="o">.</span><span class="n">plotWaveform</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>see Obspy stream.plot()</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>obspy.core.stream.Stream</dt>
                                <dd id="Stream.traces" class="variable">traces</dd>
                <dd id="Stream.count" class="function">count</dd>
                <dd id="Stream.append" class="function">append</dd>
                <dd id="Stream.extend" class="function">extend</dd>
                <dd id="Stream.get_gaps" class="function">get_gaps</dd>
                <dd id="Stream.insert" class="function">insert</dd>
                <dd id="Stream.spectrogram" class="function">spectrogram</dd>
                <dd id="Stream.pop" class="function">pop</dd>
                <dd id="Stream.print_gaps" class="function">print_gaps</dd>
                <dd id="Stream.remove" class="function">remove</dd>
                <dd id="Stream.reverse" class="function">reverse</dd>
                <dd id="Stream.sort" class="function">sort</dd>
                <dd id="Stream.trim" class="function">trim</dd>
                <dd id="Stream.cutout" class="function">cutout</dd>
                <dd id="Stream.slice" class="function">slice</dd>
                <dd id="Stream.slide" class="function">slide</dd>
                <dd id="Stream.verify" class="function">verify</dd>
                <dd id="Stream.merge" class="function">merge</dd>
                <dd id="Stream.simulate" class="function">simulate</dd>
                <dd id="Stream.filter" class="function">filter</dd>
                <dd id="Stream.trigger" class="function">trigger</dd>
                <dd id="Stream.resample" class="function">resample</dd>
                <dd id="Stream.decimate" class="function">decimate</dd>
                <dd id="Stream.max" class="function">max</dd>
                <dd id="Stream.differentiate" class="function">differentiate</dd>
                <dd id="Stream.integrate" class="function">integrate</dd>
                <dd id="Stream.detrend" class="function">detrend</dd>
                <dd id="Stream.taper" class="function">taper</dd>
                <dd id="Stream.interpolate" class="function">interpolate</dd>
                <dd id="Stream.std" class="function">std</dd>
                <dd id="Stream.normalize" class="function">normalize</dd>
                <dd id="Stream.rotate" class="function">rotate</dd>
                <dd id="Stream.copy" class="function">copy</dd>
                <dd id="Stream.clear" class="function">clear</dd>
                <dd id="Stream.split" class="function">split</dd>
                <dd id="Stream.attach_response" class="function">attach_response</dd>
                <dd id="Stream.remove_response" class="function">remove_response</dd>
                <dd id="Stream.remove_sensitivity" class="function">remove_sensitivity</dd>
                <dd id="Stream.stack" class="function">stack</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="is_valid">
                            <input id="is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">st_in</span>, </span><span class="param"><span class="n">return_stream</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">STA</span><span class="o">=</span><span class="mf">0.005</span>, </span><span class="param"><span class="n">LTA</span><span class="o">=</span><span class="mf">0.1</span>, </span><span class="param"><span class="n">min_num_valid</span><span class="o">=</span><span class="mi">5</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="is_valid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="is_valid-309"><a href="#is_valid-309"><span class="linenos">309</span></a><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="n">st_in</span><span class="p">,</span> <span class="n">return_stream</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">STA</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">LTA</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">min_num_valid</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
</span><span id="is_valid-310"><a href="#is_valid-310"><span class="linenos">310</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="is_valid-311"><a href="#is_valid-311"><span class="linenos">311</span></a><span class="sd">        Determine if an event is valid or return valid traces in a  stream</span>
</span><span id="is_valid-312"><a href="#is_valid-312"><span class="linenos">312</span></a><span class="sd">        :param st_in: stream</span>
</span><span id="is_valid-313"><a href="#is_valid-313"><span class="linenos">313</span></a><span class="sd">        :type st_in: uquake.core.stream.Stream</span>
</span><span id="is_valid-314"><a href="#is_valid-314"><span class="linenos">314</span></a><span class="sd">        :param return_stream: return stream of valid traces if true else return</span>
</span><span id="is_valid-315"><a href="#is_valid-315"><span class="linenos">315</span></a><span class="sd">        true if the event is valid</span>
</span><span id="is_valid-316"><a href="#is_valid-316"><span class="linenos">316</span></a><span class="sd">        :type return_stream: bool</span>
</span><span id="is_valid-317"><a href="#is_valid-317"><span class="linenos">317</span></a><span class="sd">        :param STA: short term average used to determine if an event is valid</span>
</span><span id="is_valid-318"><a href="#is_valid-318"><span class="linenos">318</span></a><span class="sd">        :type STA: float</span>
</span><span id="is_valid-319"><a href="#is_valid-319"><span class="linenos">319</span></a><span class="sd">        :param LTA: long term average</span>
</span><span id="is_valid-320"><a href="#is_valid-320"><span class="linenos">320</span></a><span class="sd">        :type LTA: float</span>
</span><span id="is_valid-321"><a href="#is_valid-321"><span class="linenos">321</span></a><span class="sd">        :param min_num_valid: minimum number of valid traces to declare the</span>
</span><span id="is_valid-322"><a href="#is_valid-322"><span class="linenos">322</span></a><span class="sd">        event valid</span>
</span><span id="is_valid-323"><a href="#is_valid-323"><span class="linenos">323</span></a><span class="sd">        :type min_num_valid: int</span>
</span><span id="is_valid-324"><a href="#is_valid-324"><span class="linenos">324</span></a><span class="sd">        :rtype: bool or uquake.core.stream.Stream</span>
</span><span id="is_valid-325"><a href="#is_valid-325"><span class="linenos">325</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="is_valid-326"><a href="#is_valid-326"><span class="linenos">326</span></a>
</span><span id="is_valid-327"><a href="#is_valid-327"><span class="linenos">327</span></a>    <span class="kn">from</span> <span class="nn">scipy.ndimage.filters</span> <span class="kn">import</span> <span class="n">gaussian_filter1d</span>
</span><span id="is_valid-328"><a href="#is_valid-328"><span class="linenos">328</span></a>    <span class="kn">from</span> <span class="nn">obspy.signal.trigger</span> <span class="kn">import</span> <span class="n">recursive_sta_lta</span>
</span><span id="is_valid-329"><a href="#is_valid-329"><span class="linenos">329</span></a>
</span><span id="is_valid-330"><a href="#is_valid-330"><span class="linenos">330</span></a>    <span class="n">st</span> <span class="o">=</span> <span class="n">st_in</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="is_valid-331"><a href="#is_valid-331"><span class="linenos">331</span></a>    <span class="n">st</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s1">&#39;demean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
</span><span id="is_valid-332"><a href="#is_valid-332"><span class="linenos">332</span></a>    <span class="n">trstd</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="is_valid-333"><a href="#is_valid-333"><span class="linenos">333</span></a>    <span class="n">trmax</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="is_valid-334"><a href="#is_valid-334"><span class="linenos">334</span></a>    <span class="n">trs_out</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="is_valid-335"><a href="#is_valid-335"><span class="linenos">335</span></a>    <span class="n">st_comp</span> <span class="o">=</span> <span class="n">composite_traces</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
</span><span id="is_valid-336"><a href="#is_valid-336"><span class="linenos">336</span></a>
</span><span id="is_valid-337"><a href="#is_valid-337"><span class="linenos">337</span></a>    <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st_comp</span><span class="p">:</span>
</span><span id="is_valid-338"><a href="#is_valid-338"><span class="linenos">338</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
</span><span id="is_valid-339"><a href="#is_valid-339"><span class="linenos">339</span></a>            <span class="k">continue</span>
</span><span id="is_valid-340"><a href="#is_valid-340"><span class="linenos">340</span></a>        <span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>
</span><span id="is_valid-341"><a href="#is_valid-341"><span class="linenos">341</span></a>        <span class="n">trstd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
</span><span id="is_valid-342"><a href="#is_valid-342"><span class="linenos">342</span></a>        <span class="n">trmax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>
</span><span id="is_valid-343"><a href="#is_valid-343"><span class="linenos">343</span></a>        <span class="n">nsta</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">STA</span> <span class="o">*</span> <span class="n">sampling_rate</span><span class="p">)</span>
</span><span id="is_valid-344"><a href="#is_valid-344"><span class="linenos">344</span></a>        <span class="n">nlta</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">LTA</span> <span class="o">*</span> <span class="n">sampling_rate</span><span class="p">)</span>
</span><span id="is_valid-345"><a href="#is_valid-345"><span class="linenos">345</span></a>        <span class="n">cft</span> <span class="o">=</span> <span class="n">recursive_sta_lta</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="n">nsta</span><span class="p">,</span> <span class="n">nlta</span><span class="p">)</span>
</span><span id="is_valid-346"><a href="#is_valid-346"><span class="linenos">346</span></a>        <span class="n">sfreq</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;sampling_rate&#39;</span><span class="p">]</span>
</span><span id="is_valid-347"><a href="#is_valid-347"><span class="linenos">347</span></a>        <span class="n">sigma</span> <span class="o">=</span> <span class="n">sfreq</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="is_valid-348"><a href="#is_valid-348"><span class="linenos">348</span></a>        <span class="n">cft</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">cft</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;reflect&#39;</span><span class="p">)</span>
</span><span id="is_valid-349"><a href="#is_valid-349"><span class="linenos">349</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="is_valid-350"><a href="#is_valid-350"><span class="linenos">350</span></a>            <span class="n">mx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="n">cft</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">&gt;</span> <span class="n">cft</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">&amp;</span> \
</span><span id="is_valid-351"><a href="#is_valid-351"><span class="linenos">351</span></a>                 <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">cft</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">cft</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="kc">True</span><span class="p">]</span>
</span><span id="is_valid-352"><a href="#is_valid-352"><span class="linenos">352</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="is_valid-353"><a href="#is_valid-353"><span class="linenos">353</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="is_valid-354"><a href="#is_valid-354"><span class="linenos">354</span></a>            <span class="k">continue</span>
</span><span id="is_valid-355"><a href="#is_valid-355"><span class="linenos">355</span></a>
</span><span id="is_valid-356"><a href="#is_valid-356"><span class="linenos">356</span></a>        <span class="n">i1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">mx</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="is_valid-357"><a href="#is_valid-357"><span class="linenos">357</span></a>        <span class="n">i2</span> <span class="o">=</span> <span class="n">i1</span><span class="p">[</span><span class="n">cft</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">cft</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="is_valid-358"><a href="#is_valid-358"><span class="linenos">358</span></a>
</span><span id="is_valid-359"><a href="#is_valid-359"><span class="linenos">359</span></a>        <span class="n">tspan</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">i2</span><span class="p">))</span> <span class="o">/</span> <span class="n">sampling_rate</span>
</span><span id="is_valid-360"><a href="#is_valid-360"><span class="linenos">360</span></a>
</span><span id="is_valid-361"><a href="#is_valid-361"><span class="linenos">361</span></a>        <span class="n">ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="is_valid-362"><a href="#is_valid-362"><span class="linenos">362</span></a>
</span><span id="is_valid-363"><a href="#is_valid-363"><span class="linenos">363</span></a>        <span class="n">accept</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="is_valid-364"><a href="#is_valid-364"><span class="linenos">364</span></a>
</span><span id="is_valid-365"><a href="#is_valid-365"><span class="linenos">365</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="is_valid-366"><a href="#is_valid-366"><span class="linenos">366</span></a>            <span class="k">if</span> <span class="n">ratio</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="is_valid-367"><a href="#is_valid-367"><span class="linenos">367</span></a>                <span class="n">accept</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="is_valid-368"><a href="#is_valid-368"><span class="linenos">368</span></a>
</span><span id="is_valid-369"><a href="#is_valid-369"><span class="linenos">369</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="is_valid-370"><a href="#is_valid-370"><span class="linenos">370</span></a>            <span class="n">accept</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="is_valid-371"><a href="#is_valid-371"><span class="linenos">371</span></a>        <span class="c1"># else:</span>
</span><span id="is_valid-372"><a href="#is_valid-372"><span class="linenos">372</span></a>        <span class="c1">#     if ratio &lt; 4:</span>
</span><span id="is_valid-373"><a href="#is_valid-373"><span class="linenos">373</span></a>        <span class="c1">#         accept = False</span>
</span><span id="is_valid-374"><a href="#is_valid-374"><span class="linenos">374</span></a>
</span><span id="is_valid-375"><a href="#is_valid-375"><span class="linenos">375</span></a>        <span class="k">if</span> <span class="n">tspan</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
</span><span id="is_valid-376"><a href="#is_valid-376"><span class="linenos">376</span></a>            <span class="n">accept</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="is_valid-377"><a href="#is_valid-377"><span class="linenos">377</span></a>
</span><span id="is_valid-378"><a href="#is_valid-378"><span class="linenos">378</span></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">tspan</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">tspan</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">):</span>
</span><span id="is_valid-379"><a href="#is_valid-379"><span class="linenos">379</span></a>            <span class="k">if</span> <span class="n">ratio</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="is_valid-380"><a href="#is_valid-380"><span class="linenos">380</span></a>                <span class="n">accept</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="is_valid-381"><a href="#is_valid-381"><span class="linenos">381</span></a>
</span><span id="is_valid-382"><a href="#is_valid-382"><span class="linenos">382</span></a>        <span class="k">if</span> <span class="n">accept</span><span class="p">:</span>
</span><span id="is_valid-383"><a href="#is_valid-383"><span class="linenos">383</span></a>            <span class="k">for</span> <span class="n">tr_accepted</span> <span class="ow">in</span> <span class="n">st_in</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">station</span><span class="o">=</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span><span class="p">):</span>
</span><span id="is_valid-384"><a href="#is_valid-384"><span class="linenos">384</span></a>                <span class="n">trs_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tr_accepted</span><span class="p">)</span>
</span><span id="is_valid-385"><a href="#is_valid-385"><span class="linenos">385</span></a>
</span><span id="is_valid-386"><a href="#is_valid-386"><span class="linenos">386</span></a>    <span class="n">st_out</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="n">trs_out</span><span class="p">)</span>
</span><span id="is_valid-387"><a href="#is_valid-387"><span class="linenos">387</span></a>
</span><span id="is_valid-388"><a href="#is_valid-388"><span class="linenos">388</span></a>    <span class="k">if</span> <span class="n">return_stream</span><span class="p">:</span>
</span><span id="is_valid-389"><a href="#is_valid-389"><span class="linenos">389</span></a>        <span class="k">return</span> <span class="n">st_out</span>
</span><span id="is_valid-390"><a href="#is_valid-390"><span class="linenos">390</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="is_valid-391"><a href="#is_valid-391"><span class="linenos">391</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">unique_stations</span><span class="p">())</span> <span class="o">&gt;=</span> <span class="n">min_num_valid</span><span class="p">:</span>
</span><span id="is_valid-392"><a href="#is_valid-392"><span class="linenos">392</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="is_valid-393"><a href="#is_valid-393"><span class="linenos">393</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="is_valid-394"><a href="#is_valid-394"><span class="linenos">394</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Determine if an event is valid or return valid traces in a  stream</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>st_in</strong>:  stream</li>
<li><strong>return_stream</strong>:  return stream of valid traces if true else return
true if the event is valid</li>
<li><strong>STA</strong>:  short term average used to determine if an event is valid</li>
<li><strong>LTA</strong>:  long term average</li>
<li><strong>min_num_valid</strong>:  minimum number of valid traces to declare the
event valid</li>
</ul>
</div>


                </section>
                <section id="check_for_dead_trace">
                            <input id="check_for_dead_trace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_for_dead_trace</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">tr</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="check_for_dead_trace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#check_for_dead_trace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="check_for_dead_trace-397"><a href="#check_for_dead_trace-397"><span class="linenos">397</span></a><span class="k">def</span> <span class="nf">check_for_dead_trace</span><span class="p">(</span><span class="n">tr</span><span class="p">):</span>
</span><span id="check_for_dead_trace-398"><a href="#check_for_dead_trace-398"><span class="linenos">398</span></a>    <span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-6</span>
</span><span id="check_for_dead_trace-399"><a href="#check_for_dead_trace-399"><span class="linenos">399</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="check_for_dead_trace-400"><a href="#check_for_dead_trace-400"><span class="linenos">400</span></a>    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="check_for_dead_trace-401"><a href="#check_for_dead_trace-401"><span class="linenos">401</span></a>    <span class="nb">max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">mean</span>
</span><span id="check_for_dead_trace-402"><a href="#check_for_dead_trace-402"><span class="linenos">402</span></a>    <span class="nb">min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">mean</span>
</span><span id="check_for_dead_trace-403"><a href="#check_for_dead_trace-403"><span class="linenos">403</span></a>    <span class="c1"># print(&#39;%s: mean:%f max:%f min:%f&#39; % (tr.get_id(), mean, max, min))</span>
</span><span id="check_for_dead_trace-404"><a href="#check_for_dead_trace-404"><span class="linenos">404</span></a>
</span><span id="check_for_dead_trace-405"><a href="#check_for_dead_trace-405"><span class="linenos">405</span></a>    <span class="k">if</span> <span class="nb">max</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">min</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span>
</span><span id="check_for_dead_trace-406"><a href="#check_for_dead_trace-406"><span class="linenos">406</span></a>        <span class="k">return</span> <span class="mi">1</span>
</span><span id="check_for_dead_trace-407"><a href="#check_for_dead_trace-407"><span class="linenos">407</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="check_for_dead_trace-408"><a href="#check_for_dead_trace-408"><span class="linenos">408</span></a>        <span class="k">return</span> <span class="mi">0</span>
</span></pre></div>


    

                </section>
                <section id="composite_traces">
                            <input id="composite_traces-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">composite_traces</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">st_in</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="composite_traces-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#composite_traces"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="composite_traces-411"><a href="#composite_traces-411"><span class="linenos">411</span></a><span class="k">def</span> <span class="nf">composite_traces</span><span class="p">(</span><span class="n">st_in</span><span class="p">):</span>
</span><span id="composite_traces-412"><a href="#composite_traces-412"><span class="linenos">412</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="composite_traces-413"><a href="#composite_traces-413"><span class="linenos">413</span></a><span class="sd">    Requires length and sampling_rates equal for all traces</span>
</span><span id="composite_traces-414"><a href="#composite_traces-414"><span class="linenos">414</span></a><span class="sd">    returns a new stream object containing composite trace for all station.</span>
</span><span id="composite_traces-415"><a href="#composite_traces-415"><span class="linenos">415</span></a><span class="sd">    The amplitude of the composite traces are the norm of the amplitude of</span>
</span><span id="composite_traces-416"><a href="#composite_traces-416"><span class="linenos">416</span></a><span class="sd">    the trace of all component and the phase of the trace (sign) is the sign</span>
</span><span id="composite_traces-417"><a href="#composite_traces-417"><span class="linenos">417</span></a><span class="sd">    of the first components of a given station.</span>
</span><span id="composite_traces-418"><a href="#composite_traces-418"><span class="linenos">418</span></a><span class="sd">    :param st_in: a stream object</span>
</span><span id="composite_traces-419"><a href="#composite_traces-419"><span class="linenos">419</span></a><span class="sd">    :type st_in: ~uquake.core.stream.Stream</span>
</span><span id="composite_traces-420"><a href="#composite_traces-420"><span class="linenos">420</span></a><span class="sd">    :rtype: ~uquake.core.stream.Stream</span>
</span><span id="composite_traces-421"><a href="#composite_traces-421"><span class="linenos">421</span></a>
</span><span id="composite_traces-422"><a href="#composite_traces-422"><span class="linenos">422</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="composite_traces-423"><a href="#composite_traces-423"><span class="linenos">423</span></a>
</span><span id="composite_traces-424"><a href="#composite_traces-424"><span class="linenos">424</span></a>    <span class="n">trsout</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="composite_traces-425"><a href="#composite_traces-425"><span class="linenos">425</span></a>
</span><span id="composite_traces-426"><a href="#composite_traces-426"><span class="linenos">426</span></a>    <span class="n">st</span> <span class="o">=</span> <span class="n">st_in</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="composite_traces-427"><a href="#composite_traces-427"><span class="linenos">427</span></a>    <span class="n">st</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s1">&#39;demean&#39;</span><span class="p">)</span>
</span><span id="composite_traces-428"><a href="#composite_traces-428"><span class="linenos">428</span></a>
</span><span id="composite_traces-429"><a href="#composite_traces-429"><span class="linenos">429</span></a>    <span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="n">st</span><span class="o">.</span><span class="n">unique_instruments</span><span class="p">:</span>
</span><span id="composite_traces-430"><a href="#composite_traces-430"><span class="linenos">430</span></a>        <span class="n">trs</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</span><span id="composite_traces-431"><a href="#composite_traces-431"><span class="linenos">431</span></a>
</span><span id="composite_traces-432"><a href="#composite_traces-432"><span class="linenos">432</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">trs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="composite_traces-433"><a href="#composite_traces-433"><span class="linenos">433</span></a>            <span class="n">trsout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="composite_traces-434"><a href="#composite_traces-434"><span class="linenos">434</span></a>
</span><span id="composite_traces-435"><a href="#composite_traces-435"><span class="linenos">435</span></a>            <span class="k">continue</span>
</span><span id="composite_traces-436"><a href="#composite_traces-436"><span class="linenos">436</span></a>
</span><span id="composite_traces-437"><a href="#composite_traces-437"><span class="linenos">437</span></a>        <span class="n">npts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="composite_traces-438"><a href="#composite_traces-438"><span class="linenos">438</span></a>        <span class="n">buf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">trs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="composite_traces-439"><a href="#composite_traces-439"><span class="linenos">439</span></a>
</span><span id="composite_traces-440"><a href="#composite_traces-440"><span class="linenos">440</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">trs</span><span class="p">:</span>
</span><span id="composite_traces-441"><a href="#composite_traces-441"><span class="linenos">441</span></a>            <span class="n">dat</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">data</span>
</span><span id="composite_traces-442"><a href="#composite_traces-442"><span class="linenos">442</span></a>            <span class="n">buf</span> <span class="o">+=</span> <span class="p">(</span><span class="n">dat</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dat</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="composite_traces-443"><a href="#composite_traces-443"><span class="linenos">443</span></a>
</span><span id="composite_traces-444"><a href="#composite_traces-444"><span class="linenos">444</span></a>        <span class="n">buf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">trs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
</span><span id="composite_traces-445"><a href="#composite_traces-445"><span class="linenos">445</span></a>        <span class="n">stats</span> <span class="o">=</span> <span class="n">trs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="composite_traces-446"><a href="#composite_traces-446"><span class="linenos">446</span></a>        <span class="n">ch</span> <span class="o">=</span> <span class="n">st_in</span><span class="o">.</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span>
</span><span id="composite_traces-447"><a href="#composite_traces-447"><span class="linenos">447</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="composite_traces-448"><a href="#composite_traces-448"><span class="linenos">448</span></a>            <span class="n">prefix</span> <span class="o">=</span> <span class="n">ch</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="composite_traces-449"><a href="#composite_traces-449"><span class="linenos">449</span></a>        <span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">C&#39;</span>
</span><span id="composite_traces-450"><a href="#composite_traces-450"><span class="linenos">450</span></a>        <span class="n">trsout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Trace</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">buf</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">header</span><span class="o">=</span><span class="n">stats</span><span class="p">))</span>
</span><span id="composite_traces-451"><a href="#composite_traces-451"><span class="linenos">451</span></a>
</span><span id="composite_traces-452"><a href="#composite_traces-452"><span class="linenos">452</span></a>    <span class="k">return</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="n">trsout</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Requires length and sampling_rates equal for all traces
returns a new stream object containing composite trace for all station.
The amplitude of the composite traces are the norm of the amplitude of
the trace of all component and the phase of the trace (sign) is the sign
of the first components of a given station.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>st_in</strong>:  a stream object</li>
</ul>
</div>


                </section>
                <section id="read">
                            <input id="read-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span>, </span><span class="param"><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;MSEED&#39;</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="read-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#read"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="read-455"><a href="#read-455"><span class="linenos">455</span></a><span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;MSEED&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="read-456"><a href="#read-456"><span class="linenos">456</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">Path</span><span class="p">):</span>
</span><span id="read-457"><a href="#read-457"><span class="linenos">457</span></a>        <span class="n">filename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="read-458"><a href="#read-458"><span class="linenos">458</span></a>
</span><span id="read-459"><a href="#read-459"><span class="linenos">459</span></a>    <span class="k">if</span> <span class="nb">format</span> <span class="ow">in</span> <span class="n">ENTRY_POINTS</span><span class="p">[</span><span class="s1">&#39;waveform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="read-460"><a href="#read-460"><span class="linenos">460</span></a>        <span class="n">format_ep</span> <span class="o">=</span> <span class="n">ENTRY_POINTS</span><span class="p">[</span><span class="s1">&#39;waveform&#39;</span><span class="p">][</span><span class="nb">format</span><span class="p">]</span>
</span><span id="read-461"><a href="#read-461"><span class="linenos">461</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="read-462"><a href="#read-462"><span class="linenos">462</span></a>            <span class="n">read_format</span> <span class="o">=</span> <span class="n">load_entry_point</span><span class="p">(</span><span class="n">format_ep</span><span class="o">.</span><span class="n">dist</span><span class="o">.</span><span class="n">key</span><span class="p">,</span>
</span><span id="read-463"><a href="#read-463"><span class="linenos">463</span></a>                                           <span class="s1">&#39;uquake.io.waveform.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
</span><span id="read-464"><a href="#read-464"><span class="linenos">464</span></a>                                           <span class="n">format_ep</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;readFormat&#39;</span><span class="p">)</span>
</span><span id="read-465"><a href="#read-465"><span class="linenos">465</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="read-466"><a href="#read-466"><span class="linenos">466</span></a>            <span class="k">return</span> <span class="n">Stream</span><span class="p">(</span>
</span><span id="read-467"><a href="#read-467"><span class="linenos">467</span></a>                <span class="n">stream</span><span class="o">=</span><span class="n">obsstream</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</span><span id="read-468"><a href="#read-468"><span class="linenos">468</span></a>
</span><span id="read-469"><a href="#read-469"><span class="linenos">469</span></a>        <span class="n">st</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">read_format</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</span><span id="read-470"><a href="#read-470"><span class="linenos">470</span></a>
</span><span id="read-471"><a href="#read-471"><span class="linenos">471</span></a>        <span class="c1"># making sure the channel names are upper case</span>
</span><span id="read-472"><a href="#read-472"><span class="linenos">472</span></a>        <span class="n">trs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="read-473"><a href="#read-473"><span class="linenos">473</span></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st</span><span class="p">:</span>
</span><span id="read-474"><a href="#read-474"><span class="linenos">474</span></a>            <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="read-475"><a href="#read-475"><span class="linenos">475</span></a>            <span class="n">trs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="read-476"><a href="#read-476"><span class="linenos">476</span></a>
</span><span id="read-477"><a href="#read-477"><span class="linenos">477</span></a>        <span class="n">st</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="n">trs</span>
</span><span id="read-478"><a href="#read-478"><span class="linenos">478</span></a>
</span><span id="read-479"><a href="#read-479"><span class="linenos">479</span></a>        <span class="k">return</span> <span class="n">st</span>
</span><span id="read-480"><a href="#read-480"><span class="linenos">480</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="read-481"><a href="#read-481"><span class="linenos">481</span></a>        <span class="k">return</span> <span class="n">Stream</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">obsstream</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Read waveform files into an ObsPy <code>~<a href="#Stream">Stream</a></code>
object.</p>

<p>The <code>~<a href="#read">read()</a></code> function opens either one or multiple
waveform files given via file name or URL using the <code>pathname_or_url</code>
attribute.</p>

<p>The format of the waveform file will be automatically detected if not
given. See the <code>Supported Formats</code>_ section below for available formats.</p>

<p>This function returns an ObsPy <code>~<a href="#Stream">Stream</a></code> object, a
<code>list</code>-like object of multiple ObsPy <code>~<a href="trace.html#Trace">uquake.core.trace.Trace</a></code>
objects.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pathname_or_url</strong>:  String containing a file name or a URL, a Path
object, or a open file-like object. Wildcards are allowed for a file
name. If this attribute is omitted, an example
<code>~<a href="#Stream">Stream</a></code> object will be returned.</li>
<li><strong>format</strong>:  Format of the file to read (e.g. <code>"MSEED"</code>). See
the <code>Supported Formats</code>_ section below for a list of supported formats.
If format is set to <code>None</code> it will be automatically detected which
results in a slightly slower reading. If a format is specified, no
further format checking is done.</li>
<li><strong>headonly</strong>:  If set to <code>True</code>, read only the data header. This is
most useful for scanning available meta information of huge data sets.</li>
<li><strong>starttime</strong>:  Specify the start time to read.</li>
<li><strong>endtime</strong>:  Specify the end time to read.</li>
<li><strong>nearest_sample</strong>:  Only applied if <code>starttime</code> or <code>endtime</code> is given.
Select nearest sample or the one containing the specified time. For
more info, see <code>~<a href="trace.html#Trace.trim">uquake.core.trace.Trace.trim()</a></code>.</li>
<li><strong>dtype</strong>:  Convert data of all traces into given numpy.dtype.</li>
<li><strong>apply_calib</strong>:  Automatically applies the calibration factor
<code>trace.stats.calib</code> for each trace, if set. Defaults to <code>False</code>.</li>
<li><strong>check_compression</strong>:  Check for compression on file and decompress
if needed. This may be disabled for a moderate speed up.</li>
<li><strong>kwargs</strong>:  Additional keyword arguments passed to the underlying
waveform reader method.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>An ObsPy <code>~<a href="#Stream">Stream</a></code> object.</p>
</blockquote>

<p>.. rubric:: Basic Usage</p>

<p>In most cases a filename is specified as the only argument to
<code>~<a href="#read">read()</a></code>. For a quick start you may omit all
arguments and ObsPy will create and return a basic example seismogram.
Further usages of the <code>~<a href="#read">read()</a></code> function can
be seen in the <code>Further Examples</code>_ section underneath.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">uquake</span> <span class="kn">import</span> <span class="n">read</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>  <span class="c1"># doctest: +ELLIPSIS</span>
<span class="go">3 Trace(s) in Stream:</span>
<span class="go">BW.RJOB..EHZ | 2009-08-24T00:20:03.000000Z - ... | 100.0 Hz, 3000 samples</span>
<span class="go">BW.RJOB..EHN | 2009-08-24T00:20:03.000000Z - ... | 100.0 Hz, 3000 samples</span>
<span class="go">BW.RJOB..EHE | 2009-08-24T00:20:03.000000Z - ... | 100.0 Hz, 3000 samples</span>
</code></pre>
</div>

<p>.. rubric:: _<code>Supported Formats</code></p>

<p>Additional ObsPy modules extend the functionality of the
<code>~<a href="#read">read()</a></code> function. The following table summarizes
all known file formats currently supported by ObsPy. The table order also
reflects the order of the autodetection routine if no format option is
specified.</p>

<p>Please refer to the <code>Linked Function Call</code>_ of each module for any extra
options available at the import stage.</p>

<p>=============== =========================== ============================================
Format          Used Module                 _<code>Linked Function Call</code> <br />
=============== =========================== ============================================
AH              <code>uquake.io.ah</code>          <code>uquake.io.ah.core._read_ah()</code> <br />
ALSEP_PSE       <code>uquake.io.alsep</code>       <code>uquake.io.alsep.core._read_pse()</code> <br />
ALSEP_WTH       <code>uquake.io.alsep</code>       <code>uquake.io.alsep.core._read_wth()</code> <br />
ALSEP_WTN       <code>uquake.io.alsep</code>       <code>uquake.io.alsep.core._read_wtn()</code> <br />
CSS             <code>uquake.io.css</code>         <code>uquake.io.css.core._read_css()</code> <br />
DMX             <code>uquake.io.dmx</code>         <code>uquake.io.dmx.core._read_dmx()</code> <br />
GCF             <code>uquake.io.gcf</code>         <code>uquake.io.gcf.core._read_gcf()</code> <br />
GSE1            <code>uquake.io.gse2</code>        <code>uquake.io.gse2.core._read_gse1()</code> <br />
GSE2            <code>uquake.io.gse2</code>        <code>uquake.io.gse2.core._read_gse2()</code> <br />
KINEMETRICS_EVT <code>uquake.io.kinemetrics</code> <code>uquake.io.kinemetrics.core.read_evt()</code> <br />
KNET            <code>uquake.io.nied</code>        <code>uquake.io.nied.knet._read_knet_ascii()</code> 
MSEED           <code>uquake.io.mseed</code>       <code>uquake.io.mseed.core._read_mseed()</code> <br />
NNSA_KB_CORE    <code>uquake.io.css</code>         <code>uquake.io.css.core._read_nnsa_kb_core()</code>
PDAS            <code>uquake.io.pdas</code>        <code>uquake.io.pdas.core._read_pdas()</code> <br />
PICKLE          <code><a href="">uquake.core.stream</a></code>    <code>uquake.core.stream._read_pickle()</code> <br />
Q               <code>uquake.io.sh</code>          <code>uquake.io.sh.core._read_q()</code> <br />
REFTEK130       <code>uquake.io.reftek</code>      <code>uquake.io.reftek.core._read_reftek130()</code>
RG16            <code>uquake.io.rg16</code>        <code>uquake.io.rg16.core._read_rg16()</code> <br />
SAC             <code>uquake.io.sac</code>         <code>uquake.io.sac.core._read_sac()</code> <br />
SACXY           <code>uquake.io.sac</code>         <code>uquake.io.sac.core._read_sac_xy()</code> <br />
SEG2            <code>uquake.io.seg2</code>        <code>uquake.io.seg2.seg2._read_seg2()</code> <br />
SEGY            <code>uquake.io.segy</code>        <code>uquake.io.segy.core._read_segy()</code> <br />
SEISAN          <code>uquake.io.seisan</code>      <code>uquake.io.seisan.core._read_seisan()</code> <br />
SH_ASC          <code>uquake.io.sh</code>          <code>uquake.io.sh.core._read_asc()</code> <br />
SLIST           <code>uquake.io.ascii</code>       <code>uquake.io.ascii.core._read_slist()</code> <br />
SU              <code>uquake.io.segy</code>        <code>uquake.io.segy.core._read_su()</code> <br />
TSPAIR          <code>uquake.io.ascii</code>       <code>uquake.io.ascii.core._read_tspair()</code> <br />
WAV             <code>uquake.io.wav</code>         <code>uquake.io.wav.core._read_wav()</code> <br />
WIN             <code>uquake.io.win</code>         <code>uquake.io.win.core._read_win()</code> <br />
Y               <code>uquake.io.y</code>           <code>uquake.io.y.core._read_y()</code> <br />
=============== =========================== ============================================</p>

<p>Next to the <code>~<a href="#read">read()</a></code> function the
<code>~<a href="#Stream.write">Stream.write()</a></code> method of the returned
<code>~<a href="#Stream">Stream</a></code> object can be used to export the data
to the file system.</p>

<p>.. rubric:: _<code>Further Examples</code></p>

<p>Example waveform files may be retrieved via <a href="https://examples.uquake.org">https://examples.uquake.org</a>.</p>

<p>(1) Reading multiple local files using wildcards.</p>

<pre><code>The following code uses wildcards, in this case it matches two files.
Both files are then read into a single
`~<a href="#Stream">Stream</a>` object.

&gt;&gt;&gt; from uquake import read  # doctest: +SKIP
&gt;&gt;&gt; st = read("/path/to/loc_R*.z")  # doctest: +SKIP
&gt;&gt;&gt; print(st)  # doctest: +SKIP
2 Trace(s) in Stream:
.RJOB..Z | 2005-08-31T02:33:49.850000Z - ... | 200.0 Hz, 12000 samples
.RNON..Z | 2004-06-09T20:05:59.850000Z - ... | 200.0 Hz, 12000 samples
</code></pre>

<p>(2) Reading a local file without format detection.</p>

<pre><code>Using the ``format`` parameter disables the automatic detection and
enforces reading a file in a given format.

&gt;&gt;&gt; from uquake import read
&gt;&gt;&gt; st = read("/path/to/loc_RJOB20050831023349.z", format="GSE2")
&gt;&gt;&gt; print(st)  # doctest: +ELLIPSIS
1 Trace(s) in Stream:
.RJOB..Z | 2005-08-31T02:33:49.850000Z - ... | 200.0 Hz, 12000 samples
</code></pre>

<p>(3) Reading a remote file via HTTP protocol.</p>

<pre><code>&gt;&gt;&gt; from uquake import read
&gt;&gt;&gt; st = read("https://examples.uquake.org/loc_RJOB20050831023349.z")
&gt;&gt;&gt; print(st)  # doctest: +ELLIPSIS
1 Trace(s) in Stream:
.RJOB..Z | 2005-08-31T02:33:49.850000Z - ... | 200.0 Hz, 12000 samples
</code></pre>

<p>(4) Reading a compressed files.</p>

<pre><code>&gt;&gt;&gt; from uquake import read
&gt;&gt;&gt; st = read("/path/to/tspair.ascii.gz")
&gt;&gt;&gt; print(st)  # doctest: +ELLIPSIS
1 Trace(s) in Stream:
XX.TEST..BHZ | 2008-01-15T00:00:00.025000Z - ... | 40.0 Hz, 635 samples

&gt;&gt;&gt; st = read("https://examples.uquake.org/slist.ascii.bz2")
&gt;&gt;&gt; print(st)  # doctest: +ELLIPSIS
1 Trace(s) in Stream:
XX.TEST..BHZ | 2008-01-15T00:00:00.025000Z - ... | 40.0 Hz, 635 samples
</code></pre>

<p>(5) Reading a file-like object.</p>

<pre><code>&gt;&gt;&gt; import requests
&gt;&gt;&gt; import io
&gt;&gt;&gt; example_url = "https://examples.uquake.org/loc_RJOB20050831023349.z"
&gt;&gt;&gt; stringio_obj = io.BytesIO(requests.get(example_url).content)
&gt;&gt;&gt; st = read(stringio_obj)
&gt;&gt;&gt; print(st)  # doctest: +ELLIPSIS
1 Trace(s) in Stream:
.RJOB..Z | 2005-08-31T02:33:49.850000Z - ... | 200.0 Hz, 12000 samples
</code></pre>

<p>(6) Using 'starttime' and 'endtime' parameters</p>

<pre><code>&gt;&gt;&gt; from uquake import read
&gt;&gt;&gt; dt = UTCDateTime("2005-08-31T02:34:00")
&gt;&gt;&gt; st = read("https://examples.uquake.org/loc_RJOB20050831023349.z",
...           starttime=dt, endtime=dt+10)
&gt;&gt;&gt; print(st)  # doctest: +ELLIPSIS
1 Trace(s) in Stream:
.RJOB..Z | 2005-08-31T02:34:00.000000Z - ... | 200.0 Hz, 2001 samples
</code></pre>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>